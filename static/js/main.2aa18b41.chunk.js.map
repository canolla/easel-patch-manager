{"version":3,"sources":["store/actions.ts","store/dispatch.ts","util.ts","components/jack.tsx","components/labelText.tsx","midiMessages.ts","store/reducer.ts","store/store.ts","midi.ts","components/cable.tsx","components/fader.tsx","components/knob.tsx","components/section.tsx","components/toggleSwitch.tsx","components/modules/complexOscillator.tsx","indexedDB.ts","components/modules/dualLoPassGates.tsx","components/modules/envelopeGenerator.tsx","components/modules/modulationOscillator.tsx","components/modules/patchbay.tsx","components/modules/pulser.tsx","components/modules/sequencer.tsx","components/iconButton.tsx","components/icons/downloadIcon.tsx","components/icons/folderIcon.tsx","components/icons/midiIcon.tsx","components/icons/saveIcon.tsx","components/titleInput.tsx","components/modules/topBar.tsx","components/easel.tsx","components/common/util.ts","components/common/Button.tsx","components/common/FocusList.tsx","components/common/Dropdown.tsx","components/modals/midiOutputSelector.tsx","components/common/FocusTrap.tsx","components/modals/modal.tsx","components/modals/downloadModal.tsx","components/modals/fileModal.tsx","components/modals/midiModal.tsx","components/modals/saveModal.tsx","components/modals/appModal.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["UPDATE_FADER","UPDATE_SWITCH","SET_DRAG_POINT","CONNECT_CV","DISCONNECT_CV","SET_MIDI_INPUT","SET_MIDI_OUTPUT","SET_PATCH","SET_PATCH_NAME","SET_MIDI_SPEED","SET_PATCH_EDITED","SHOW_MODAL","HIDE_MODAL","OPEN_SAVED_PATCH","dispatchUpdateFader","module","param","value","type","dispatchUpdateSwitch","dispatchSetMIDIOutput","name","dispatchHideModal","dispatchOpenSavedPatch","patch","CancellationToken","isCancelled","this","encodePatch","bytes","forEachValue","addBytes","connections","connection","start","connectionPoint","id","end","color","encodeURIComponent","btoa","data","numBytes","i","String","fromCharCode","decodePatch","encoded","atob","decodeURIComponent","offset","out","sequencer","triggerSelect","stages","voltage1","voltage2","voltage3","voltage4","voltage5","pulse1","pulse2","pulse3","pulse4","pulse5","envelope","attack","sustain","decay","modeSelect","pulser","period","periodCV","modOsc","keyboard","waveshape","range","modulationType","frequency","frequencyCV","modulation","modulationCV","complexOsc","polarity","pitch","pitchCV","timbre","timbreCV","timbreKnob","gates","gate2Source","gate1Mode","gate2Mode","level1","level1CV","level2","level2CV","random","triggerSource","current","charCodeAt","readByte","res","length","push","cb","result","Object","keys","sort","Array","isArray","possible","indexOf","toSVGCoordinate","svg","x","y","point","createSVGPoint","matrixTransform","getScreenCTM","inverse","distance","x0","y0","x1","y1","Math","sqrt","pow","cleanPatchName","title","replace","formatLastEditedDate","date","now","then","seconds","isNaN","describePlural","floor","describetime","Date","unit","createPreviewURI","clone","cloneNode","style","document","createElementNS","appendChild","textContent","previewCSS","content","querySelector","setAttribute","bg","insertBefore","firstChild","selector","objs","querySelectorAll","item","remove","text","XMLSerializer","serializeToString","ConnectionPoint","LabelText","props","anchor","alignment","className","filter","e","join","textAnchor","alignmentBaseline","fill","OUTER_RADIUS","mapDispatchToProps","dispatchSetDragPoint","Jack","connect","state","ownProps","arrow","arrowY","transform","ref","rect","getBoundingClientRect","ownerSVGElement","left","width","top","height","cx","cy","r","stroke","x2","y2","d","definitions","messageNames","connectionIds","getMessageName","getMessageByName","find","getMessageTemplateBytes","key","getMessageBytes","getMessageTemplate","template","split","Uint8Array","parseInt","createFaderMessage","saveBuffer","max","min","createSwitchMessage","num","createConnectCVMessage","from","to","msg","outputName","swap","createDisconnectCVMessage","createPatchMessages","easel","clearBuffer","saveIndex","queue","isSave","undefined","rawValue","messageName","startsWith","prefix","set","createSetNameMessage","createSaveMessage","getReadableName","readableNames","initialState","dragPoints","midiSpeed","sendMIDI","interval","lastTime","rateLimit","output","action","sendMIDIMessage","startPoint","endPoint","cvCount","setDragPoint","map","p","makeConnection","existing","startId","endId","takenColors","nextColor","slice","concat","breakConnection","c","defaultModalState","midiAccessPromise","store","createStore","midiOutput","saved","patchEdited","midiInput","modal","modalType","speed","edited","getAccessAsync","a","navigator","requestMIDIAccess","sysex","listMIDIOutputsAsync","access","outputs","entry","inputs","get","send","messages","onProgress","cancellationToken","Promise","resolve","reject","currentIndex","intervalRef","setInterval","clearInterval","messageInterval","getState","Cable","colorIndex","onClick","pathString","strokeWidth","strokeLinecap","MAX_VALUE","FADER_HEIGHT","FADER_WIDTH","FaderView","fader","label","g","window","PointerEvent","frameRef","throttled","cancelAnimationFrame","requestAnimationFrame","buttons","eventPoint","clientX","clientY","rectPoint","pointerUpdate","addEventListener","onKeyDown","preventDefault","stopPropagation","tabIndex","role","aria-valuemin","aria-valuemax","aria-valuenow","aria-label","aria-orientation","fillOpacity","rx","opacity","KNOB_RADIUS","Knob","minAngle","PI","maxAngle","angle","innerArcFlag","atan2","cos","sin","KNOB_THICKNESS","Section","children","TOGGLE_WIDTH","ToggleSwitch","topOption","middleOption","bottomOption","twoWay","onChange","TOGGLE_HEIGHT","charCode","which","keyCode","TOGGLE_HANDLE_RADIUS_RATIO","_db","openPromise","ComplexOscillatorView","DualLoPassGates","EnvelopeGenerator","ModulationOscillator","Patchbay","PulseOutput","PressureOutput","PitchOutput","EnvelopeAttackInput","SequentialVoltageOutput","EnvelopeSustainInput","EnvelopeDecayInput","RandomOutput","PulserPeriodInput","EnvelopeGeneratorOutput","ModulationOscFrequencyInput","PulserOutput","ModulationOscModulationInput","ComplexOscPitchInput","ComplexOscTimbreInput","LoPassGate1Input","LoPassGate2Input","Pulser","Sequencer","PATCH_DB_NAME","initDBAsync","request","indexedDB","open","onerror","event","onupgradeneeded","objectStore","createObjectStore","autoIncrement","keyPath","createIndex","unique","onsuccess","addEntryAsync","db","transaction","add","updateEntryAsync","toStore","lastSavedTime","put","listEntriesAsync","openCursor","allEntries","cursor","continue","savePatchAsync","preview","createdTime","updatePatchAsync","IconButton","ev","DownloadIcon","FolderIcon","MidiIcon","SaveIcon","TitleInput","React","currentValue","setCurrentValue","currentTarget","onBlur","blur","dispatchSetPatchName","dispatchShowModal","TopBar","patchNotSaved","patchName","svgRef","onSaveClicked","saveResult","ModulationCVOutput","PanelInput","Panel1Output","Panel2Output","ComplexOscWaveshapeInput","EnvelopeDetectorOutput","input","console","log","dispatchConnectCV","dispatchDisconnectCV","Easel","dragStart","setDragStart","dragEnd","setDragEnd","initAsync","getDragPoint","svgCoordinate","onPointerDown","dragPoint","onPointerUp","startName","endName","onPointerMove","onPointerLeave","removeEventListener","cables","index","viewBox","xmlns","patternUnits","patternTransform","fireClickOnEnter","click","classList","classes","reduce","prev","trim","Button","ariaLabel","ariaHidden","ariaDescribedBy","ariaControls","ariaExpanded","ariaHasPopup","ariaPosInSet","ariaSetSize","ariaSelected","onKeydown","buttonRef","leftIcon","rightIcon","hardDisabled","href","target","disabled","aria-hidden","aria-controls","aria-expanded","aria-haspopup","aria-posinset","aria-setsize","aria-describedby","aria-selected","FocusList","focusableElements","focusList","childTabStopId","onItemReceivedFocus","useUpAndDownArrowKeys","activeElement","focus","element","dispatchEvent","Event","focusable","values","childTabStop","Dropdown","container","items","selectedId","onItemSelected","expanded","setExpanded","selected","contains","relatedTarget","selectedIndex","aria-labelledby","some","MidiOutputSelector","useState","midiOutputs","setMidiOutputs","useEffect","device","selectedOutput","FocusTrap","onEscape","arrowKeyNavigation","dontStealFocus","includeOutsideTabOrder","stoleFocus","setStoleFocus","getElements","list","node","nodeListToArray","moveFocus","forward","goToEnd","shiftKey","Modal","onCloseClick","actions","dispatchSetMidiSpeed","DownloadModal","selectedSlot","setSelectedSlot","sendingPatch","setSendingPatch","progress","setProgress","setCancellationToken","saveSlots","cancel","outId","inId","createDisconnectAllMessages","token","sendMIDIMessagesAsync","total","round","empty","backgroundImage","FileModal","savedProjects","setSavedProjects","allPatchesAsync","onPatchClick","src","alt","dispatchSetMIDIInput","MidiModal","midiInputs","setMidiInputs","listMIDIInputsAsync","selectedInput","SaveModal","AppModal","modalState","subscribe","timeout","clearTimeout","setTimeout","throttle","location","dispatch","dispatchSetPatchEdited","dispatchSetPatch","hash","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2aa18b41.chunk.js","sourcesContent":["export const UPDATE_FADER = \"UPDATE_FADER\";\nexport const UPDATE_SWITCH = \"UPDATE_SWITCH\";\nexport const SET_DRAG_POINT = \"SET_DRAG_POINT\";\nexport const CONNECT_CV = \"CONNECT_CV\";\nexport const DISCONNECT_CV = \"DISCONNECT_CV\";\n\nexport const SET_MIDI_INPUT = \"SET_MIDI_INPUT\";\nexport const SET_MIDI_OUTPUT = \"SET_MIDI_OUTPUT\";\nexport const SET_PATCH = \"SET_PATCH\";\nexport const SET_PATCH_NAME = \"SET_PATCH_NAME\";\nexport const SET_MIDI_SPEED = \"SET_MIDI_SPEED\";\nexport const SET_PATCH_EDITED = \"SET_PATCH_EDITED\";\n\nexport const SHOW_MODAL = \"SHOW_MODAL\";\nexport const HIDE_MODAL = \"HIDE_MODAL\";\n\nexport const OPEN_SAVED_PATCH = \"OPEN_SAVED_PATCH\";","// export interface Easel {\n//     sequencer: SequentialVoltageSource;\n//     envelope: EnvelopeGenerator;\n//     pulser: Pulser;\n//     modOsc: ModulationOscillator;\n//     complexOsc: ComplexOscillator;\n//     gates: DualLoPassGate;\n//     random: Random;\n//     connections: boolean[][];\n// }\n\nimport { ConnectionPoint } from \"../components/jack\";\nimport { SavedPatch } from \"../indexedDB\";\nimport { ComplexOscillator, DualLoPassGate, Easel, EnvelopeGenerator, ModulationOscillator, Pulser, Random, SwitchValue, ModalType, MidiMessageSpeed } from \"../types\";\nimport { CONNECT_CV, DISCONNECT_CV, HIDE_MODAL, OPEN_SAVED_PATCH, SET_DRAG_POINT, SET_MIDI_INPUT, SET_MIDI_OUTPUT, SET_MIDI_SPEED, SET_PATCH, SET_PATCH_EDITED, SET_PATCH_NAME, SHOW_MODAL, UPDATE_FADER, UPDATE_SWITCH } from \"./actions\";\n\n\nexport function dispatchUpdateFader(module: \"envelope\", param: keyof EnvelopeGenerator, value: number): any;\nexport function dispatchUpdateFader(module: \"pulser\", param: keyof Pulser, value: number): any;\nexport function dispatchUpdateFader(module: \"modOsc\", param: keyof ModulationOscillator, value: number): any;\nexport function dispatchUpdateFader(module: \"complexOsc\", param: keyof ComplexOscillator, value: number): any;\nexport function dispatchUpdateFader(module: \"gates\", param: keyof DualLoPassGate, value: number): any;\nexport function dispatchUpdateFader(module: \"random\", param: keyof Random, value: number): any;\nexport function dispatchUpdateFader(module: keyof Easel, param: string, value: number) {\n    return {\n        type: UPDATE_FADER,\n        module,\n        param,\n        value\n    };\n};\n\nexport function dispatchUpdateSwitch(module: \"envelope\", param: keyof EnvelopeGenerator, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: \"pulser\", param: keyof Pulser, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: \"modOsc\", param: keyof ModulationOscillator, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: \"complexOsc\", param: keyof ComplexOscillator, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: \"gates\", param: keyof DualLoPassGate, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: \"random\", param: keyof Random, value: SwitchValue): any;\nexport function dispatchUpdateSwitch(module: keyof Easel, param: string, value: SwitchValue) {\n    return {\n        type: UPDATE_SWITCH,\n        module,\n        param,\n        value\n    };\n};\n\nexport function dispatchSetDragPoint(connectionPoint: ConnectionPoint, id: number, x: number, y: number) {\n    return {\n        type: SET_DRAG_POINT,\n        connectionPoint,\n        id,\n        x,\n        y\n    }\n}\n\nexport function dispatchConnectCV(startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) {\n    return {\n        type: CONNECT_CV,\n        startPoint,\n        startId,\n        endPoint,\n        endId\n    }\n}\n\nexport function dispatchDisconnectCV(startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) {\n    return {\n        type: DISCONNECT_CV,\n        startPoint,\n        startId,\n        endPoint,\n        endId\n    }\n}\n\nexport function dispatchSetMIDIInput(name: string) {\n    return {\n        type: SET_MIDI_INPUT,\n        name\n    }\n}\n\nexport function dispatchSetMIDIOutput(name: string) {\n    return {\n        type: SET_MIDI_OUTPUT,\n        name\n    }\n}\n\nexport function dispatchSetPatch(patch: Easel) {\n    return {\n        type: SET_PATCH,\n        patch\n    }\n}\n\nexport function dispatchSetPatchName(name: string) {\n    return {\n        type: SET_PATCH_NAME,\n        name\n    }\n}\n\nexport function dispatchShowModal(modalType: ModalType) {\n    return {\n        modalType,\n        type: SHOW_MODAL\n    }\n}\n\nexport function dispatchHideModal() {\n    return {\n        type: HIDE_MODAL\n    }\n}\n\nexport function dispatchOpenSavedPatch(patch: SavedPatch) {\n    return {\n        patch,\n        type: OPEN_SAVED_PATCH\n    }\n}\n\nexport function dispatchSetMidiSpeed(speed: MidiMessageSpeed) {\n    return {\n        speed,\n        type: SET_MIDI_SPEED\n    }\n}\n\nexport function dispatchSetPatchEdited(edited: boolean) {\n    return {\n        edited,\n        type: SET_PATCH_EDITED\n    }\n}","import { getMessageName } from \"./midiMessages\";\nimport { Connection, Easel } from \"./types\";\n\nexport class CancellationToken {\n    isCancelled = false;\n\n    cancel() {\n        this.isCancelled = true;\n    }\n}\n\nexport function encodePatch(patch: Easel) {\n    let bytes = \"\";\n\n    forEachValue(patch, (value, bytes) => {\n        addBytes(value, bytes);\n        return 0;\n    });\n\n    for (const connection of patch.connections) {\n        addBytes(connection.start.connectionPoint, 1);\n        addBytes(connection.start.id, 1);\n        addBytes(connection.end.connectionPoint, 1);\n        addBytes(connection.end.id, 1);\n        addBytes(connection.color, 1);\n    }\n\n    return encodeURIComponent(btoa(bytes));\n\n    function addBytes(data: number, numBytes: number) {\n        for (let i = 0; i < numBytes; i++) {\n            bytes += String.fromCharCode((data >> (i * 8)) & 0xff);\n        }\n    }\n}\n\nexport function decodePatch(encoded: string) {\n    const bytes = atob(decodeURIComponent(encoded));\n\n    let offset = 0;\n\n    const out = forEachValue(emptyPatch(), (value, numBytes) => {\n        let current = 0;\n\n        for (let i = 0; i < numBytes; i++) {\n            current |= (bytes.charCodeAt(offset) << (i * 8))\n            offset++;\n        }\n\n        return current;\n    });\n\n    out.connections = [];\n\n    const readByte = () => {\n        const res = bytes.charCodeAt(offset);\n        offset++;\n        return res;\n    }\n\n    for (let i = offset; i < bytes.length; i += 5) {\n        const connection: Connection = {\n            start: {\n                connectionPoint: readByte(),\n                id: readByte()\n            },\n            end: {\n                connectionPoint: readByte(),\n                id: readByte()\n            },\n            color: readByte()\n        }\n\n        out.connections.push(connection);\n    }\n\n    return out;\n}\n\nexport function emptyPatch(): Easel {\n    return {\n        sequencer: {\n            triggerSelect: \"bottom\",\n            stages: \"bottom\",\n        \n            voltage1: 0,\n            voltage2: 0,\n            voltage3: 0,\n            voltage4: 0,\n            voltage5: 0,\n            pulse1: \"top\",\n            pulse2: \"top\",\n            pulse3: \"top\",\n            pulse4: \"top\",\n            pulse5: \"top\",\n        },\n        envelope: {\n            attack: 0,\n            sustain: 0,\n            decay: 0,\n            triggerSelect: \"bottom\",\n            modeSelect: \"bottom\",\n        },\n        pulser: {\n            triggerSelect: \"bottom\",\n            modeSelect: \"bottom\",\n            period: 0,\n            periodCV: 0,\n        },\n        modOsc: {\n            keyboard: \"bottom\",\n            waveshape: \"bottom\",\n            range: \"bottom\",\n            modulationType: \"bottom\",\n            frequency: 0,\n            frequencyCV: 0,\n            modulation: 0,\n            modulationCV: 0,\n        },\n        complexOsc: {\n            keyboard: \"bottom\",\n            waveshape: \"bottom\",\n            polarity: \"bottom\",\n            pitch: 0,\n            pitchCV: 0,\n            timbre: 0,\n            timbreCV: 0,\n            timbreKnob: 0,\n        },\n        gates: {\n            gate2Source: \"bottom\",\n            gate1Mode: \"bottom\",\n            gate2Mode: \"bottom\",\n            level1: 0,\n            level1CV: 0,\n            level2: 0,\n            level2CV: 0,\n        },\n        random: {\n            triggerSource: \"bottom\",\n        },\n        connections: [],\n    };\n}\n\nexport function throttle(cb: () => void, interval: number) {\n    let timeout: number | undefined;\n\n    return () => {\n        if (timeout) clearTimeout(timeout);\n\n        timeout = setTimeout(() => {\n            cb();\n            timeout = undefined;\n        }, interval) as any;\n    }\n}\n\nexport function rateLimit(cb: (...args: any) => void, interval: number) {\n    let lastTime = Date.now();\n\n    return (...args: any) => {\n        if (Date.now() - lastTime < interval) return;\n\n        lastTime = Date.now();\n        cb(...args);\n    }\n}\n\nexport function forEachValue(patch: Easel, cb: (value: number, bytes: number, module: string, param: string, originalValue: any) => number) {\n    const result: any = {};\n    for (const module of Object.keys(patch).sort()) {\n        result[module] = {};\n\n        if (module === \"connections\") continue;\n\n        for (const param of Object.keys((patch as any)[module]).sort()) {\n            const current = (patch as any)[module][param];\n\n            if (Array.isArray(current)) continue;\n            \n            if (typeof current === \"string\") {\n                const possible = [\"top\", \"bottom\", \"middle\"];\n                result[module][param] = possible[cb(possible.indexOf(current), 1, module, param, current)];\n            }\n            else {\n                result[module][param] = cb(current, 2, module, param, current);\n            }\n        }\n    }\n\n    return result as Easel;\n}\n\nexport function toSVGCoordinate(svg: SVGSVGElement, x: number, y: number) {\n    const point = svg.createSVGPoint();\n    point.x = x;\n    point.y = y;\n    return point.matrixTransform(svg.getScreenCTM()?.inverse());\n}\n\nexport function distance(x0: number, y0: number, x1: number, y1: number) {\n    return Math.sqrt(Math.pow(x0 - x1, 2) + Math.pow(y0 - y1, 2));\n}\n\nexport function cleanPatchName(title: string) {\n    return title.replace(/[^a-zA-Z0-9 ]/g, \"\");\n}\n\nexport function formatLastEditedDate(date: number) {\n    return describetime(Date.now() / 1000, date / 1000)\n}\n\nfunction describePlural(value: number, unit: string) {\n    return value + \" \" + unit + (value == 1 ? \"\" : \"s\")\n}\nfunction describetime(now: number, then: number) {\n    const seconds = now - then\n    if (isNaN(seconds)) return \"\"\n    if (seconds < 0)\n        return \"now\"\n    else if (seconds < 10)\n        return \"a few seconds ago\"\n    else if (seconds < 60)\n        return \" \" + describePlural(Math.floor(seconds), \"second\") + \" ago\"\n    else if (seconds < 2 * 60)\n        return \"a minute ago\"\n    else if (seconds < 60 * 60)\n        return \" \" + describePlural(Math.floor(seconds / 60), \"minute\") + \" ago\"\n    else if (seconds < 2 * 60 * 60)\n        return \"an hour ago\";\n    else if (seconds < 60 * 60 * 24)\n        return \" \" + describePlural(Math.floor(seconds / 60 / 60), \"hour\") + \" ago\"\n    else if (seconds < 60 * 60 * 24 * 30)\n        return \" \" + describePlural(Math.floor(seconds / 60 / 60 / 24), \"day\") + \" ago\"\n    else if (seconds < 60 * 60 * 24 * 365)\n        return \" \" + describePlural(Math.floor(seconds / 60 / 60 / 24 / 30), \"month\") + \" ago\"\n    else\n        return \" \" + describePlural(Math.floor(seconds / 60 / 60 / 24 / 365), \"year\") + \" ago\"\n}\n\nexport function createPreviewURI(svg: SVGSVGElement) {\n    const clone = svg.cloneNode(true) as SVGSVGElement;\n\n    const style = document.createElementNS(\"http://www.w3.org/2000/svg\", \"style\");\n    clone.appendChild(style);\n    style.textContent = previewCSS;\n\n    const content = clone.querySelector(\".easel-content\");\n\n    clone.setAttribute(\"viewBox\", \"0 0 1588 778\");\n    content?.setAttribute(\"transform\", \"translate(6, 6)\")\n\n    const bg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n    bg.setAttribute(\"x\", \"2\");\n    bg.setAttribute(\"y\", \"2\");\n    bg.setAttribute(\"width\", \"1582\");\n    bg.setAttribute(\"height\", \"750\");\n    bg.setAttribute(\"fill\", \"var(--color-preview-bg)\");\n\n    clone.insertBefore(bg, clone.firstChild)\n\n    const selectorsToRemove = [\n        \".title-input\",\n        \".easel-text\",\n        \".icon-button\",\n        \".jack-arrow\",\n        \".wave-path\",\n        \".easel-fader-bg.filled\",\n        \"foreignObject\",\n        \".knob-fg-outline\",\n        \".knob-bg\"\n    ]\n\n    for (const selector of selectorsToRemove) {\n        const objs = clone.querySelectorAll(selector);\n    \n        for (let i = 0; i < objs.length; i++) {\n            objs.item(i).remove();\n        }\n    }\n\n    const text = new XMLSerializer().serializeToString(clone);\n    return \"data:image/svg+xml;base64,\" + btoa(text);\n}\n\nconst previewCSS = `\n* {\n    --color-preview-fg: #1a2c7d;\n    --color-preview-bg: #fff;\n\n    --color-sequencer: var(--color-preview-fg);\n    --color-envelope-generator: var(--color-preview-fg);\n    --color-pulser: var(--color-preview-fg);\n    --color-modulation-oscillator: var(--color-preview-fg);\n    --color-complex-oscillator: var(--color-preview-fg);\n    --color-dual-lo-pass-gate: var(--color-preview-fg);\n    --color-random-voltage: var(--color-preview-fg);\n\n    --color-keyboard-pulse: var(--color-preview-fg);\n    --color-keyboard-pressure: var(--color-preview-fg);\n    --color-keyboard-pitch: var(--color-preview-fg);\n    --color-input: var(--color-preview-fg);\n\n    --color-outline: var(--color-preview-fg);\n    --color-background: var(--color-preview-bg);\n    --color-switch-bg: var(--color-preview-bg);\n    --color-inner-jack: var(--color-preview-bg);\n\n    --color-cable-0: var(--color-preview-bg);\n    --color-cable-1: var(--color-preview-bg);\n    --color-cable-2: var(--color-preview-bg);\n    --color-cable-3: var(--color-preview-bg);\n    --color-cable-4: var(--color-preview-bg);\n    --color-cable-5: var(--color-preview-bg);\n    --color-cable-6: var(--color-preview-bg);\n    --color-cable-7: var(--color-preview-bg);\n    --color-cable-8: var(--color-preview-bg);\n\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\n}\n.easel-text {\n    fill: var(--color-outline);\n    font-size: 14px;\n    user-select: none;\n}\n.section>rect {\n    stroke-width: 8;\n}\n.cable-bg {\n    stroke-width: 20;\n}\n.easel-jack>circle {\n    stroke: none;\n}\n.easel-toggle>circle {\n    fill: var(--color-preview-bg);\n    stroke: none;\n    transform: translate(0, 13px);\n}\n.easel-toggle>rect {\n    transform: translate(0, 13px);\n    stroke-width: 4;\n}\n.easel-toggle-bg {\n    fill: var(--color-preview-fg);\n}\n.knob-fg {\n    stroke: var(--color-preview-bg);\n}\n.knob-bg-outline {\n    stroke-width: 26;\n}\n.easel-knob>path {\n    transform: translate(0, 10px);\n}\n.easel-fader-bg {\n    fill-opacity: 1;\n    stroke-width: 4;\n}\n`","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { dispatchSetDragPoint } from \"../store/dispatch\";\nimport { State } from \"../store/reducer\";\nimport { toSVGCoordinate } from \"../util\";\nimport { LabelText } from \"./labelText\";\n\nexport enum ConnectionPoint {\n    PulseOutput,\n    PressureOutput,\n    PitchOutput,\n    SequentialVoltageOutput,\n    EnvelopeGeneratorOutput,\n    PulserOutput,\n    RandomOutput,\n    Panel1Output,\n    Panel2Output,\n    EnvelopeDetectorOutput,\n    ModulationCVOutput,\n    PulserPeriodInput,\n    ModulationOscFrequencyInput,\n    ModulationOscModulationInput,\n    ComplexOscPitchInput,\n    ComplexOscTimbreInput,\n    LoPassGate1Input,\n    LoPassGate2Input,\n    PanelInput,\n    EnvelopeAttackInput,\n    EnvelopeSustainInput,\n    EnvelopeDecayInput,\n    ComplexOscWaveshapeInput\n}\n\nexport interface JackProps {\n    x: number;\n    y: number;\n    color: string;\n    connectionPoint: ConnectionPoint;\n    id?: number;\n    arrow?: \"long\" | \"medium\" | \"short\";\n    text?: string;\n\n    dispatchSetDragPoint: (connectionPoint: ConnectionPoint, id: number, x: number, y: number) => void;\n}\n\nconst OUTER_RADIUS = 25;\nconst INNER_RADIUS = 12;\n\nexport const JackImpl = (props: JackProps) => {\n    const { x, y, text, color, connectionPoint, id, arrow, dispatchSetDragPoint } = props;\n\n    const handleCircleRef = (ref: SVGCircleElement) => {\n        if (ref) {\n            const rect = ref.getBoundingClientRect();\n            const point = toSVGCoordinate(\n                ref.ownerSVGElement!,\n                rect.left + rect.width / 2,\n                rect.top + rect.height / 2\n            )\n            dispatchSetDragPoint(connectionPoint, id || 0, point.x, point.y);\n        }\n    }\n\n    let arrowY = 0;\n    if (arrow === \"long\") {\n        arrowY = -OUTER_RADIUS - 78;\n    }\n    else if (arrow === \"medium\") {\n        arrowY = -OUTER_RADIUS - 42;\n    }\n    else {\n        arrowY = -OUTER_RADIUS - 12;\n    }\n\n    return <>\n        <g className=\"easel-jack\" transform={`translate(${x} ${y})`}>        \n            <circle\n                ref={handleCircleRef}\n                cx={0}\n                cy={0}\n                r={OUTER_RADIUS}\n                fill={color}\n                stroke=\"var(--color-outline)\" />\n            <circle \n                cx={0}\n                cy={0}\n                r={INNER_RADIUS}\n                fill=\"var(--color-inner-jack)\"\n                stroke=\"var(--color-outline)\"  />\n            {text && \n                <LabelText\n                    text={text}\n                    x={0}\n                    y={OUTER_RADIUS + 20}\n                    alignment=\"baseline\"\n                    anchor=\"middle\" />\n            }\n            {arrow &&\n                <g className=\"jack-arrow\">\n                    <line\n                        x1={0}\n                        y1={-OUTER_RADIUS}\n                        x2={0}\n                        y2={arrowY}\n                        stroke=\"var(--color-outline)\" />\n                    <path\n                        d={`M 0 ${arrowY - 2} l ${4} ${10} q ${-4} ${-4} ${-8} ${0} Z`}\n                        fill=\"var(--color-outline)\"\n                    />\n                </g>\n            }\n        </g>\n    </>\n}\n\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchSetDragPoint,\n};\n\nexport const Jack = connect(mapStateToProps, mapDispatchToProps)(JackImpl);","import * as React from \"react\";\n\nimport \"../styles/labelText.css\"\n\nexport interface LabelTextProps {\n    className?: string;\n    x: number;\n    y: number;\n    text: string;\n    anchor?: \"start\" | \"middle\" | \"end\"\n    alignment?: \"hanging\" | \"middle\" | \"baseline\"\n}\n\nexport const LabelText = (props: LabelTextProps) => {\n    const { x, y, text, anchor, alignment, className } = props;\n    return <text \n        className={[\"easel-text\", className].filter(e => !!e).join(\" \")}\n        x={x}\n        y={y}\n        textAnchor={anchor}\n        alignmentBaseline={alignment}\n        fill=\"var(--color-outline)\">\n            {text}\n        </text>\n}\n","import { ConnectionPoint } from \"./components/jack\";\nimport { Easel, ParamKind } from \"./types\";\nimport { forEachValue } from \"./util\";\n\nconst definitions = [\n    {\n        \"name\": \"cv_connect\",\n        \"length\": 35,\n        \"template\": \"F0 24 2F 63 76 5F 63 6F 6E 6E 65 63 74 00 2C 69 69 69 66 00 00 00 00 00 00 00 00 00 00 XX 00 00 00 XX 3F F7 80 00 00\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 13\n            },\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 8\n            }\n        ]\n    },\n    {\n        // This one is just cv_connect with a different suffix\n        \"name\": \"cv_disconnect\",\n        \"length\": 35,\n        \"template\": \"f0 24 2f 63 76 5f 63 6f 6e 6e 65 63 74 00 2c 69 69 69 66 00 00 00 00 00 00 00 00 00 00 XX 00 00 00 XX 00 00 00 00 f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 13\n            },\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 8\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_co_cvsPitch\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 63 6f 5f 63 76 73 50 69 74 63 68 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 14\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 123\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_co_cvsTimbre\",\n        \"length\": 35,\n        \"template\": \"f0 20 2f 66 64 5f 63 6f 5f 63 76 73 54 69 6d 62 72 65 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 32,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 125\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_co_pitch\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 63 6f 5f 70 69 74 63 68 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 125\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_co_timbre\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 63 6f 5f 74 69 6d 62 72 65 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 119\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_dlpg_cvsLevel1\",\n        \"length\": 35,\n        \"template\": \"f0 20 2f 66 64 5f 64 6c 70 67 5f 63 76 73 4c 65 76 65 6c 31 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 32,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_dlpg_cvsLevel2\",\n        \"length\": 35,\n        \"template\": \"f0 20 2f 66 64 5f 64 6c 70 67 5f 63 76 73 4c 65 76 65 6c 32 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 32,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_dlpg_level1\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 64 6c 70 67 5f 6c 65 76 65 6c 31 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 125\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_dlpg_level2\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 64 6c 70 67 5f 6c 65 76 65 6c 32 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 123\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_eg_a\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 65 67 5f 61 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_eg_d\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 65 67 5f 64 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 120\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_eg_s\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 65 67 5f 73 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 14\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 111\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_mo_cvsFreq\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 6d 6f 5f 63 76 73 46 72 65 71 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_mo_cvsMod\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 6d 6f 5f 63 76 73 4d 6f 64 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 109\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_mo_freq\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 6d 6f 5f 66 72 65 71 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_mo_mod\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 6d 6f 5f 6d 6f 64 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 113\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_p_cvs\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 70 5f 63 76 73 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 125\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_p_period\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 66 64 5f 70 5f 70 65 72 69 6f 64 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 126\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_svs_1\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 73 76 73 5f 31 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 126\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_svs_2\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 73 76 73 5f 32 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 126\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_svs_3\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 73 76 73 5f 33 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 126\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_svs_4\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 73 76 73 5f 34 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 123\n            }\n        ]\n    },\n    {\n        \"name\": \"fd_svs_5\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 66 64 5f 73 76 73 5f 35 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 24,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 125\n            }\n        ]\n    },\n    {\n        \"name\": \"kn_co_timbre\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 6b 6e 5f 63 6f 5f 74 69 6d 62 72 65 00 00 00 2c 69 69 00 00 00 00 00 00 00 XX XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 28,\n                \"min\": 0,\n                \"max\": 15\n            },\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 127\n            }\n        ]\n    },\n    {\n        \"name\": \"rt_keyDown\",\n        \"length\": 23,\n        \"template\": \"f0 14 2f 72 74 5f 6b 65 79 44 6f 77 6e 00 2c 69 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 21,\n                \"min\": 0,\n                \"max\": 28\n            }\n        ]\n    },\n    {\n        \"name\": \"rt_keyUp\",\n        \"length\": 23,\n        \"template\": \"f0 14 2f 72 74 5f 6b 65 79 55 70 00 00 00 2c 69 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 21,\n                \"min\": 0,\n                \"max\": 28\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_co_keyboard\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 63 6f 5f 6b 65 79 62 6f 61 72 64 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_co_polarity\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 63 6f 5f 70 6f 6c 61 72 69 74 79 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_co_timbre\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 63 6f 5f 74 69 6d 62 72 65 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_eg_mode\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 65 67 5f 6d 6f 64 65 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_eg_trigger\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 65 67 5f 74 72 69 67 67 65 72 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_gate1Mode\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 67 61 74 65 31 4d 6f 64 65 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_gate2Mode\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 67 61 74 65 32 4d 6f 64 65 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_gate2Source\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 67 61 74 65 32 53 6f 75 72 63 65 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_mo_keyboard\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 6d 6f 5f 6b 65 79 62 6f 61 72 64 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_mo_mod\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 6d 6f 5f 6d 6f 64 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_mo_range\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 6d 6f 5f 72 61 6e 67 65 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_mo_waveshape\",\n        \"length\": 35,\n        \"template\": \"f0 20 2f 73 77 5f 6d 6f 5f 77 61 76 65 73 68 61 70 65 00 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 33,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_p_mode\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 70 5f 6d 6f 64 65 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_p_trigger\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 70 5f 74 72 69 67 67 65 72 00 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_p1\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 73 76 73 5f 70 31 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_p2\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 73 76 73 5f 70 32 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_p3\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 73 76 73 5f 70 33 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_p4\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 73 76 73 5f 70 34 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_p5\",\n        \"length\": 27,\n        \"template\": \"f0 18 2f 73 77 5f 73 76 73 5f 70 35 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 25,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_stages\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 73 76 73 5f 73 74 61 67 65 73 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_svs_trigger\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 73 76 73 5f 74 72 69 67 67 65 72 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"sw_rv_trigger\",\n        \"length\": 31,\n        \"template\": \"f0 1c 2f 73 77 5f 72 76 5f 74 72 69 67 67 65 72 00 00 2c 69 69 00 00 00 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 29,\n                \"min\": 0,\n                \"max\": 2\n            }\n        ]\n    },\n    {\n        \"name\": \"ps_clearBuffer\",\n        \"length\": 23,\n        \"template\": \"f0 14 2f 70 73 5f 63 6c 65 61 72 42 75 66 66 65 72 00 2c 00 00 00 f7 ff\",\n        \"arguments\": []\n    },\n    {\n        \"name\": \"ps_save\",\n        \"length\": 23,\n        \"template\": \"f0 14 2f 70 73 5f 73 61 76 65 00 00 00 00 2c 69 00 00 00 00 00 XX f7\",\n        \"arguments\": [\n            {\n                \"offset\": 21,\n                \"min\": 0,\n                \"max\": 1\n            }\n        ]\n    },\n    {\n        \"name\": \"ps_setName\",\n        \"length\": 35,\n        \"template\": \"f0 20 2f 70 73 5f 73 65 74 4e 61 6d 65 00 2c 69 73 00 00 00 00 01\",\n        \"arguments\": []\n    }\n];\n\nconst messageNames = {\n    sequencer: {\n        triggerSelect: \"sw_svs_trigger\",\n        stages: \"sw_svs_stages\",\n\n        voltage1: \"fd_svs_1\",\n        voltage2: \"fd_svs_2\",\n        voltage3: \"fd_svs_3\",\n        voltage4: \"fd_svs_4\",\n        voltage5: \"fd_svs_5\",\n        pulse1: \"sw_svs_p1\",\n        pulse2: \"sw_svs_p2\",\n        pulse3: \"sw_svs_p3\",\n        pulse4: \"sw_svs_p4\",\n        pulse5: \"sw_svs_p5\",\n    },\n    envelope: {\n        attack: \"fd_eg_a\",\n        sustain: \"fd_eg_d\",\n        decay: \"fd_eg_s\",\n        triggerSelect: \"sw_eg_trigger\",\n        modeSelect: \"sw_eg_mode\",\n    },\n    pulser: {\n        triggerSelect: \"sw_p_trigger\",\n        modeSelect: \"sw_p_mode\",\n        period: \"fd_p_period\",\n        periodCV: \"fd_p_cvs\",\n    },\n    modOsc: {\n        keyboard: \"sw_mo_keyboard\",\n        waveshape: \"sw_mo_waveshape\",\n        range: \"sw_mo_range\",\n        modulationType: \"sw_mo_mod\",\n        frequency: \"fd_mo_freq\",\n        frequencyCV: \"fd_mo_cvsFreq\",\n        modulation: \"fd_mo_mod\",\n        modulationCV: \"fd_mo_cvsMod\",\n    },\n    complexOsc: {\n        keyboard: \"sw_co_keyboard\",\n        waveshape: \"sw_co_timbre\",\n        polarity: \"sw_co_polarity\",\n        pitch: \"fd_co_pitch\",\n        pitchCV: \"fd_co_cvsPitch\",\n        timbre: \"fd_co_timbre\",\n        timbreCV: \"fd_co_cvsTimbre\",\n        timbreKnob: \"kn_co_timbre\",\n    },\n    gates: {\n        gate2Source: \"sw_gate2Source\",\n        gate1Mode: \"sw_gate1Mode\",\n        gate2Mode: \"sw_gate2Mode\",\n        level1: \"fd_dlpg_level1\",\n        level1CV: \"fd_dlpg_cvsLevel1\",\n        level2: \"fd_dlpg_level2\",\n        level2CV: \"fd_dlpg_cvsLevel2\",\n    },\n    random: {\n        triggerSource: \"sw_rv_trigger\",\n    }\n};\n\nconst connectionIds: { [index: string]: number } = {\n    \"SequentialVoltageOutput\": 0,\n    \"EnvelopeGeneratorOutput\": 1,\n    \"PulserOutput\": 2,\n    \"PulseOutput\": 3,\n    \"PressureOutput\": 4,\n    \"PitchOutput\": 5,\n    \"RandomOutput\": 6,\n    \"EnvelopeDetectorOutput\": 10,\n    \"ModulationCVOutput\": 11,\n    \"Panel1Output\": 12,\n    \"Panel2Output\": 13,\n    \"PulserPeriodInput\": 0,\n    \"ModulationOscFrequencyInput\": 1,\n    \"ModulationOscModulationInput\": 2,\n    \"ComplexOscPitchInput\": 3,\n    \"ComplexOscTimbreInput\": 4,\n    \"ComplexOscWaveshapeInput\": 5,\n    \"LoPassGate1Input\": 6,\n    \"LoPassGate2Input\": 7,\n    \"PanelInput\": 8,\n    \"EnvelopeAttackInput\": 9,\n    \"EnvelopeSustainInput\": 10,\n    \"EnvelopeDecayInput\": 11,\n};\n\nexport function getMessageName(module: string, param: string) {\n    return (messageNames as any)[module][param];\n}\n\nfunction getMessageByName(name: string) {\n    return definitions.find(d => d.name === name);\n}\n\nfunction getMessageTemplate(module: string, key: string) {\n    const name = getMessageName(module, key);\n    return getMessageByName(name);\n}\n\nfunction getMessageTemplateBytes(module: string, key: string) {\n    const template = getMessageTemplate(module, key)!;\n    return getMessageBytes(template.template);\n}\n\nfunction getMessageBytes(template: string) {\n    const bytes = template.split(\" \");\n    const out = new Uint8Array(bytes.length);\n    for (let i = 0; i < bytes.length; i++) {\n        if (bytes[i] == \"XX\") continue;\n        out[i] = parseInt(bytes[i], 16);\n    }\n    return out;\n}\n\nexport function createFaderMessage(module: string, key: string, value: number, saveBuffer = false) {\n    const out = getMessageTemplateBytes(module, key);\n\n    value = Math.max(0, Math.min(0x7ff, value));\n\n    out[out.length - 2] = value & 0x7f;\n    out[out.length - 3] = (value >> 7) & 0xf;\n\n    if (saveBuffer) {\n        out[out.length - 6] = 1;\n    }\n\n    return out;\n}\n\nexport function createSwitchMessage(module: string, key: string, value: \"top\" | \"middle\" | \"bottom\", saveBuffer = false) {\n    const out = getMessageTemplateBytes(module, key);\n\n    let num: number;\n    switch (value) {\n        case \"top\": num = 2; break;\n        case \"middle\": num = 1; break;\n        case \"bottom\": num = 0; break;\n    }\n\n    out[out.length - 2] = num;\n\n    if (saveBuffer) {\n        out[out.length - 6] = 1;\n    }\n\n    return out;\n}\n\nexport function createConnectCVMessage(from: number, to: number, saveBuffer = false) {\n    const msg = getMessageByName(\"cv_connect\");\n    const out = getMessageBytes(msg!.template);\n\n    let outputName = ConnectionPoint[from];\n\n    if (outputName.indexOf(\"Input\") !== -1) {\n        let swap = from;\n        from = to;\n        to = swap;\n    }\n\n    // output\n    out[29] = connectionIds[ConnectionPoint[from]]\n    // input\n    out[33] = connectionIds[ConnectionPoint[to]]\n\n    if (saveBuffer) {\n        out[25] = 1;\n    }\n\n    return out;\n}\n\nexport function createDisconnectCVMessage(from: number, to: number) {\n    const msg = getMessageByName(\"cv_disconnect\");\n    const out = getMessageBytes(msg!.template);\n\n    let outputName = ConnectionPoint[from];\n\n    if (outputName.indexOf(\"Input\") !== -1) {\n        let swap = from;\n        from = to;\n        to = swap;\n    }\n\n    // output\n    out[29] = connectionIds[ConnectionPoint[from]]\n    // input\n    out[33] = connectionIds[ConnectionPoint[to]]\n\n    return out;\n}\n\nexport function createClearBufferMessage() {\n    const msg = getMessageByName(\"ps_clearBuffer\");\n    const out = getMessageBytes(msg!.template);\n\n    return out;\n}\n\nexport function createSaveMessage(saveIndex: number) {\n    const msg = getMessageByName(\"ps_save\");\n    const out = getMessageBytes(msg!.template);\n\n    out[out.length - 2] = saveIndex;\n\n    return out;\n}\n\nexport function createSetNameMessage(name: string) {\n    const msg = getMessageByName(\"ps_setName\");\n    const prefix = getMessageBytes(msg!.template);\n    const out = new Uint8Array(prefix.length + name.length + 3);\n\n    out.set(prefix, 0);\n    for (let i = 0; i < name.length; i++) {\n        out[prefix.length + i] = name.charCodeAt(i);\n    }\n\n    out[out.length - 1] = 0xf7;\n    return out;\n}\n\nexport function createDisconnectAllMessages() {\n    const outputs = Object.keys(connectionIds).filter(key => key.indexOf(\"Output\") !== -1).map(key => connectionIds[key]);\n    const inputs = Object.keys(connectionIds).filter(key => key.indexOf(\"Output\") !== -1).map(key => connectionIds[key]);\n\n    const messages = [];\n    for (const outId of outputs) {\n        for (const inId of inputs) {\n            messages.push(createDisconnectCVMessage(outId, inId));\n        }\n    }\n\n    return messages;\n}\n\nexport function createPatchMessages(easel: Easel, clearBuffer: boolean, name?: string, saveIndex?: number) {\n    const queue: Uint8Array[] = [];\n\n    if (clearBuffer) {\n        queue.push(createClearBufferMessage());\n    }\n\n    const isSave = saveIndex !== undefined;\n\n    forEachValue(easel, (value, bytes, module, param, rawValue) => {\n        const messageName = getMessageName(module, param);\n\n        if (messageName.startsWith(\"fd\") || messageName.startsWith(\"kn\")) {\n            queue.push(createFaderMessage(module, param, rawValue, isSave));\n        }\n        else {\n            queue.push(createSwitchMessage(module, param, rawValue, isSave));\n        }\n        return 0;\n    });\n\n    for (const connection of easel.connections) {\n        queue.push(createConnectCVMessage(connection.start.connectionPoint, connection.end.connectionPoint, isSave));\n    }\n\n    if (name) {\n        queue.push(createSetNameMessage(name));\n    }\n\n    if (isSave) {\n        queue.push(createSaveMessage(saveIndex))\n    }\n\n    return queue;\n}\n\nexport function getReadableName(module: string, param: string) {\n    return readableNames[getMessageName(module, param)];\n}\n\nconst readableNames: {[index: string]: string} = {\n    \"sw_svs_trigger\": \"Sequencer Trigger Mode\",\n    \"sw_svs_stages\": \"Sequencer Stages\",\n    \"fd_svs_1\": \"Sequencer Stage 1\",\n    \"fd_svs_2\": \"Sequencer Stage 2\",\n    \"fd_svs_3\": \"Sequencer Stage 3\",\n    \"fd_svs_4\": \"Sequencer Stage 4\",\n    \"fd_svs_5\": \"Sequencer Stage 5\",\n    \"sw_svs_p1\": \"Sequqncer Pulse 1\",\n    \"sw_svs_p2\": \"Sequqncer Pulse 2\",\n    \"sw_svs_p3\": \"Sequencer Pulse 3\",\n    \"sw_svs_p4\": \"Sequencer Pulse 4\",\n    \"sw_svs_p5\": \"Sequencer Pulse 5\",\n    \"fd_eg_a\": \"Envelope Generator Attack\",\n    \"fd_eg_d\": \"Envelope Generator Decay\",\n    \"fd_eg_s\": \"Envelope Generator Sustain\",\n    \"sw_eg_trigger\": \"Envelope Trigger Mode\",\n    \"sw_eg_mode\": \"Envelope Generator Mode\",\n    \"sw_p_trigger\": \"Pulser Trigger Mode\",\n    \"sw_p_mode\": \"Pulser Mode\",\n    \"fd_p_period\": \"Pulser Period\",\n    \"fd_p_cvs\": \"Pulser Period CV\",\n    \"sw_mo_keyboard\": \"Mod Oscillator Key Tracking\",\n    \"sw_mo_waveshape\": \"Mod Oscillator Waveshape\",\n    \"sw_mo_range\": \"Mod Oscillator Range\",\n    \"sw_mo_mod\": \"Mod Oscillator Modulation Type\",\n    \"fd_mo_freq\": \"Mod Oscillator Frequency\",\n    \"fd_mo_cvsFreq\": \"Mod Oscillator Frequency CV\",\n    \"fd_mo_mod\": \"Mod Oscillator Modulation\",\n    \"fd_mo_cvsMod\": \"Mod Oscillator Moduplation CV\",\n    \"sw_co_keyboard\": \"Comp Oscillator Key Tracking\",\n    \"sw_co_timbre\": \"Comp Oscillator Waveshape Switch\",\n    \"sw_co_polarity\": \"Comp Oscillator Polarity\",\n    \"fd_co_pitch\": \"Comp Oscillator Pitch\",\n    \"fd_co_cvsPitch\": \"Comp Oscillator Pitch CV\",\n    \"fd_co_timbre\": \"Comp Oscillator Timbre\",\n    \"fd_co_cvsTimbre\": \"Comp Oscillator Timbre CV\",\n    \"kn_co_timbre\": \"Comp Oscillator Waveshape\",\n    \"sw_gate2Source\": \"Gate 2 Source\",\n    \"sw_gate1Mode\": \"Gate 1 Mode\",\n    \"sw_gate2Mode\": \"Gate 2 Mode\",\n    \"fd_dlpg_level1\": \"Gate 1 Level\",\n    \"fd_dlpg_cvsLevel1\": \"Gate 1 Level CV\",\n    \"fd_dlpg_level2\": \"Gate 2 Level\",\n    \"fd_dlpg_cvsLevel2\": \"Gate 2 Level CV\",\n    \"sw_rv_trigger\": \"Random Voltage Trigger Mode\",\n}\n\nconst paramKinds: {[index: string]: ParamKind} = {\n    \"sw_svs_trigger\": \"three-way\",\n    \"sw_svs_stages\": \"three-way\",\n    \"fd_svs_1\": \"fader\",\n    \"fd_svs_2\": \"fader\",\n    \"fd_svs_3\": \"fader\",\n    \"fd_svs_4\": \"fader\",\n    \"fd_svs_5\": \"fader\",\n    \"sw_svs_p1\": \"two-way\",\n    \"sw_svs_p2\": \"two-way\",\n    \"sw_svs_p3\": \"two-way\",\n    \"sw_svs_p4\": \"two-way\",\n    \"sw_svs_p5\": \"two-way\",\n    \"fd_eg_a\": \"fader\",\n    \"fd_eg_d\": \"fader\",\n    \"fd_eg_s\": \"fader\",\n    \"sw_eg_trigger\": \"three-way\",\n    \"sw_eg_mode\": \"three-way\",\n    \"sw_p_trigger\": \"three-way\",\n    \"sw_p_mode\": \"three-way\",\n    \"fd_p_period\": \"fader\",\n    \"fd_p_cvs\": \"fader\",\n    \"sw_mo_keyboard\": \"two-way\",\n    \"sw_mo_waveshape\": \"three-way\",\n    \"sw_mo_range\": \"two-way\",\n    \"sw_mo_mod\": \"three-way\",\n    \"fd_mo_freq\": \"fader\",\n    \"fd_mo_cvsFreq\": \"fader\",\n    \"fd_mo_mod\": \"fader\",\n    \"fd_mo_cvsMod\": \"fader\",\n    \"sw_co_keyboard\": \"two-way\",\n    \"sw_co_timbre\": \"three-way\",\n    \"sw_co_polarity\": \"two-way\",\n    \"fd_co_pitch\": \"fader\",\n    \"fd_co_cvsPitch\": \"fader\",\n    \"fd_co_timbre\": \"fader\",\n    \"fd_co_cvsTimbre\": \"fader\",\n    \"kn_co_timbre\": \"fader\",\n    \"sw_gate2Source\": \"three-way\",\n    \"sw_gate1Mode\": \"three-way\",\n    \"sw_gate2Mode\": \"three-way\",\n    \"fd_dlpg_level1\": \"fader\",\n    \"fd_dlpg_cvsLevel1\": \"fader\",\n    \"fd_dlpg_level2\": \"fader\",\n    \"fd_dlpg_cvsLevel2\": \"fader\",\n    \"sw_rv_trigger\": \"three-way\",\n}","import { ConnectionPoint } from \"../components/jack\";\nimport { SavedPatch } from \"../indexedDB\";\nimport { sendMIDIMessage } from \"../midi\";\nimport { createConnectCVMessage, createDisconnectCVMessage, createFaderMessage, createSwitchMessage } from \"../midiMessages\";\nimport { Connection, ConnectionJack, Easel, MidiMessageSpeed, ModalState, ModalType } from \"../types\";\nimport { cleanPatchName, decodePatch, emptyPatch, rateLimit } from \"../util\";\nimport { CONNECT_CV, DISCONNECT_CV, HIDE_MODAL, OPEN_SAVED_PATCH, SET_DRAG_POINT, SET_MIDI_INPUT, SET_MIDI_OUTPUT, SET_MIDI_SPEED, SET_PATCH, SET_PATCH_EDITED, SET_PATCH_NAME, SHOW_MODAL, UPDATE_FADER, UPDATE_SWITCH } from \"./actions\";\n\nexport interface State {\n    saved?: SavedPatch;\n    patch: Easel;\n    name: string;\n    dragPoints: DragPoint[];\n\n    midiInput?: string;\n    midiOutput?: string;\n    midiSpeed: MidiMessageSpeed;\n\n    modal?: ModalState;\n    patchEdited?: boolean;\n}\n\nexport interface DragPoint {\n    connectionPoint: ConnectionPoint;\n    id: number;\n    x: number;\n    y: number;\n}\n\nconst initialState: State = {\n    patch: emptyPatch(),\n    name: \"Untitled\",\n    dragPoints: [],\n    midiSpeed: \"medium\",\n}\n\nexport function topReducer(state = initialState, action: any): State {\n    sendMIDI(state.midiOutput, action, state);\n    \n    switch (action.type) {\n        case OPEN_SAVED_PATCH:\n            return {\n                ...state,\n                saved: action.patch,\n                name: action.patch.name,\n                patch: decodePatch(action.patch.patch),\n                patchEdited: false\n            };\n        case SET_PATCH:\n            return {\n                ...state,\n                patch: action.patch\n            };\n        case UPDATE_FADER:\n            return {\n                ...state,\n                patch: {\n                    ...state.patch,\n                    [action.module]: {\n                        ...state.patch[action.module as keyof Easel],\n                        [action.param]: Math.min(Math.max(action.value, 0), 0x7ff)\n                    }\n                }\n            };\n        case UPDATE_SWITCH:\n            return {\n                ...state,\n                patch: {\n                    ...state.patch,\n                    [action.module]: {\n                        ...state.patch[action.module as keyof Easel],\n                        [action.param]: action.value\n                    }\n                }\n            };\n        case SET_DRAG_POINT:\n            return {\n                ...state,\n                dragPoints: setDragPoint(\n                    state.dragPoints,\n                    action.connectionPoint,\n                    action.id,\n                    action.x,\n                    action.y\n                )\n            };\n        case CONNECT_CV:\n            return {\n                ...state,\n                patch: {\n                    ...state.patch,\n                    connections: makeConnection(\n                        state.patch.connections,\n                        action.startPoint,\n                        action.startId,\n                        action.endPoint,\n                        action.endId\n                    )\n                }\n            }\n        case DISCONNECT_CV:\n            return {\n                ...state,\n                patch: {\n                    ...state.patch,\n                    connections: breakConnection(\n                        state.patch.connections,\n                        action.startPoint,\n                        action.startId,\n                        action.endPoint,\n                        action.endId\n                    )\n                }\n            }\n        case SET_MIDI_INPUT:\n            return {\n                ...state,\n                midiInput: action.name\n            }\n        case SET_MIDI_OUTPUT:\n            return {\n                ...state,\n                midiOutput: action.name\n            }\n        case SET_PATCH_NAME:\n            return {\n                ...state,\n                name: cleanPatchName(action.name)\n            }\n        case SHOW_MODAL:\n            return {\n                ...state,\n                modal: defaultModalState(action.modalType)\n            }\n        case HIDE_MODAL:\n            return {\n                ...state,\n                modal: undefined\n            }\n        case SET_MIDI_SPEED:\n            return {\n                ...state,\n                midiSpeed: action.speed\n            }\n        case SET_PATCH_EDITED:\n            return {\n                ...state,\n                patchEdited: action.edited\n            }\n    }\n\n    return state;\n}\n\nconst sendMIDI = rateLimit((output: string | undefined, action: any, state: State) => {\n    if (!output) return;\n\n    switch (action.type) {\n        case UPDATE_FADER:\n            sendMIDIMessage(output, createFaderMessage(action.module, action.param, action.value));\n            break;\n        case UPDATE_SWITCH:\n            sendMIDIMessage(output, createSwitchMessage(action.module, action.param, action.value));\n            break;\n        case CONNECT_CV:\n            sendMIDIMessage(output, createConnectCVMessage(action.startPoint, action.endPoint))\n            break;\n        case DISCONNECT_CV:\n            // There are duplicates of some connection points, so we only want to send the message\n            // if there is exactly one connection left (the one being disconnected)\n            let cvCount = 0;\n            for (const connection of state.patch.connections) {\n                if (connection.start.connectionPoint === action.startPoint && connection.end.connectionPoint === action.endPoint ||\n                    connection.end.connectionPoint === action.startPoint && connection.start.connectionPoint === action.endPoint) {\n                    cvCount++;\n                }\n            }\n\n            if (cvCount === 1) {\n                sendMIDIMessage(output, createDisconnectCVMessage(action.startPoint, action.endPoint));\n            }\n            break;\n    }\n}, 16)\n\n\nfunction setDragPoint(dragPoints: DragPoint[], connectionPoint: ConnectionPoint, id: number, x: number, y: number) {\n    const result = dragPoints.map(p => ({...p}));\n\n    for (const point of dragPoints) {\n        if (point.connectionPoint === connectionPoint && point.id === id) {\n            point.x = x;\n            point.y = y;\n            return result;\n        }\n    }\n\n    result.push({\n        connectionPoint,\n        id,\n        x,\n        y\n    });\n\n    return result;\n}\n\nfunction makeConnection(existing: Connection[], startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) {\n    let start: ConnectionJack = {\n        connectionPoint: startPoint,\n        id: startId\n    }\n\n    let end: ConnectionJack = {\n        connectionPoint: endPoint,\n        id: endId\n    }\n\n    if (start.connectionPoint === end.connectionPoint) {\n        if (start.id > end.id) {\n            let swap = start;\n            start = end;\n            end = swap;\n        }\n    }\n    else if (start.connectionPoint > end.connectionPoint) {\n        let swap = start;\n        start = end;\n        end = swap;\n    }\n\n    const takenColors: boolean[] = [];\n    \n    for (const connection of existing) {\n        if (connection.start.connectionPoint === start.connectionPoint &&\n            connection.start.id === start.id &&\n            connection.end.connectionPoint === end.connectionPoint &&\n            connection.end.id === end.id) {\n                return existing;\n        }\n\n        takenColors[connection.color] = true;\n    }\n\n    let nextColor = takenColors.length;\n    for (let i = 0; i < takenColors.length; i++) {\n        if (!takenColors[i]) {\n            nextColor = i;\n            break;\n        }\n    }\n\n    return existing.slice().concat([{ start, end, color: nextColor }]);\n}\n\nfunction breakConnection(existing: Connection[], startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) {\n    return existing.filter(c => {\n        if (c.start.connectionPoint === startPoint && c.start.id === startId && c.end.connectionPoint === endPoint && c.end.id === endId) return false;\n        if (c.start.connectionPoint === endPoint && c.start.id === endId && c.end.connectionPoint === startPoint && c.end.id === startId) return false;\n\n        return true;\n    })\n}\n\nfunction defaultModalState(type: ModalType): ModalState {\n    return {\n        type\n    }\n}","import { createStore } from 'redux';\n\nimport { topReducer } from './reducer';\n\nconst store = createStore(topReducer);\nexport default store;","import { CancellationToken } from \"./util\";\nimport store from './store/store';\n\nlet midiAccess: WebMidi.MIDIAccess;\nlet midiAccessPromise: Promise<WebMidi.MIDIAccess>;\n\nasync function getAccessAsync() {\n    if (midiAccess) return midiAccess;\n    if (!midiAccessPromise) midiAccessPromise = navigator.requestMIDIAccess({ sysex: true });\n    return midiAccessPromise;\n}\n\nexport async function listMIDIOutputsAsync() {\n    const access = await getAccessAsync();\n\n    const out: [string, string][] = [];\n    for (const entry of access.outputs) {\n        out.push([entry[0], entry[1].name!]);\n    }\n    return out;\n}\n\nexport async function listMIDIInputsAsync() {\n    const access = await getAccessAsync();\n\n    const out: [string, string][] = [];\n    for (const entry of access.inputs) {\n        out.push([entry[0], entry[1].name!]);\n    }\n    return out;\n}\n\nexport async function sendMIDIMessage(output: string, bytes: Uint8Array) {\n    const access = await getAccessAsync();\n    const out = access.outputs.get(output);\n\n    if (out) {\n        out.send(bytes);\n    }\n}\n\nexport async function sendMIDIMessagesAsync(output: string, messages: Uint8Array[], onProgress?: (current: number, total: number) => void, cancellationToken?: CancellationToken) {\n    const access = await getAccessAsync();\n\n    const out = access.outputs.get(output);\n    if (!out) return;\n\n    return new Promise<void>((resolve, reject) => {\n        let currentIndex = 0;\n        let intervalRef = setInterval(() => {\n            if (cancellationToken?.isCancelled) {\n                clearInterval(intervalRef);\n                resolve();\n                return;\n            }\n\n            if (currentIndex === messages.length) {\n                clearInterval(intervalRef);\n\n                try {\n                    if (onProgress) onProgress(currentIndex, messages.length);\n                }\n                catch {\n                    // ignore\n                }\n\n                resolve();\n                return;\n            }\n            \n            try {\n                if (onProgress) onProgress(currentIndex, messages.length);\n            }\n            catch {\n                // ignore\n            }\n\n            try {\n                out.send(messages[currentIndex]);\n            }\n            catch (e) {\n                clearInterval(intervalRef);\n                reject(e);\n                return;\n            }\n\n            currentIndex ++;\n        }, messageInterval())\n    },)\n}\n\nexport function messageInterval() {\n    switch (store.getState().midiSpeed) {\n        case \"very-slow\": return 200;\n        case \"slow\": return 100;\n        case \"medium\": return 50;\n        case \"fast\": return 20;\n    }\n}","import * as React from \"react\";\nimport { distance } from \"../util\";\n\nexport interface CableProps {\n    x0: number;\n    y0: number;\n    x1: number;\n    y1: number;\n    colorIndex: number;\n    onClick?: () => void;\n}\n\nexport const Cable = (props: CableProps) => {\n    let { x0, y0, x1, y1, colorIndex, onClick } = props;\n\n    if (x0 < x1) {\n        let swap = x0;\n        x0 = x1;\n        x1 = swap;\n        swap = y0;\n        y0 = y1;\n        y1 = swap;\n    }\n\n\n    const d = distance(x0, y0, x1, y1);\n    const pathString = `M ${x0} ${y0} q ${(x1 - x0) / 2} ${Math.min(Math.max(10, 200 - d / 10), 100)} ${x1 - x0} ${y1 - y0}`;\n\n    return <>\n        <path\n            className=\"cable-bg\"\n            d={pathString}\n            stroke=\"var(--color-outline)\"\n            fill=\"none\"\n            strokeWidth={12}\n            strokeLinecap=\"round\"\n            onClick={onClick}\n            />\n        <path\n            d={pathString}\n            stroke={`var(--color-cable-${colorIndex % 9})`}\n            fill=\"none\"\n            strokeWidth={10}\n            strokeLinecap=\"round\"\n            onClick={onClick}\n            />\n\n    </>\n}\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { getReadableName } from \"../midiMessages\";\nimport { dispatchUpdateFader } from \"../store/dispatch\";\nimport { State } from \"../store/reducer\";\nimport { toSVGCoordinate } from \"../util\";\nimport { LabelText } from \"./labelText\";\n\nexport interface FaderProps {\n    color: string;\n    top: number;\n    left: number;\n    value: number;\n    module: string;\n    fader: string;\n    onChange?: (value: number) => void;\n    label?: string;\n\n    dispatchUpdateFader: (module: string, param: string, value: number) => void;\n}\n\nconst MAX_VALUE = 0x7ff;\nconst FADER_HEIGHT = 220;\nconst FADER_WIDTH = 15;\nconst HANDLE_WIDTH = 12;\n\nexport const FaderViewImpl = (props: FaderProps) => {\n    const { color, left, top, label, value, module, fader, dispatchUpdateFader } = props;\n\n    const attachEvents = (g: SVGGElement) => {\n        if (!g) return;\n        if (window.PointerEvent) {\n            const pointerUpdate = (e: PointerEvent) => {\n                if (!e.buttons) return;\n                const rect = g.getBoundingClientRect();\n\n                const eventPoint = toSVGCoordinate(g.ownerSVGElement!, e.clientX, e.clientY);\n                const rectPoint = toSVGCoordinate(g.ownerSVGElement!, rect.left, rect.top);\n\n                dispatchUpdateFader(module, fader, ((1 - ((eventPoint.y - rectPoint.y) / FADER_HEIGHT)) * MAX_VALUE) | 0);\n            }\n\n            let frameRef: number | undefined = undefined;;\n\n            const throttled = (e: PointerEvent) => {\n                if (frameRef) cancelAnimationFrame(frameRef);\n                frameRef = requestAnimationFrame(() => {\n                    frameRef = undefined;\n                    pointerUpdate(e);\n                })\n            }\n\n            g.addEventListener(\"pointerdown\", throttled);\n            g.addEventListener(\"pointermove\", throttled);\n        }\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent) => {\n        if (e.key === \"ArrowUp\" || e.key === \"ArrowRight\" || e.key === \"PageUp\") {\n            dispatchUpdateFader(module, fader, Math.min(value + 100, MAX_VALUE));\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"ArrowDown\" || e.key === \"ArrowLeft\" || e.key === \"PageDown\") {\n            dispatchUpdateFader(module, fader, Math.max(value - 100, 0));\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"End\") {\n            dispatchUpdateFader(module, fader, MAX_VALUE);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"Home\") {\n            dispatchUpdateFader(module, fader, 0);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n\n    const offset = (1 - (value / MAX_VALUE)) * FADER_HEIGHT;\n\n    return <g\n        transform={`translate(${left}, ${top})`}\n        ref={attachEvents}\n        onKeyDown={onKeyDown}\n        tabIndex={0}\n        role=\"slider\"\n        aria-valuemin={0}\n        aria-valuemax={MAX_VALUE}\n        aria-valuenow={value}\n        aria-label={getReadableName(module, fader)}\n        aria-orientation=\"vertical\">\n        <rect className=\"easel-fader-bg\"\n            fill={color}\n            height={FADER_HEIGHT}\n            width={FADER_WIDTH / 3}\n            x={FADER_WIDTH / 3}\n            y={0}\n            fillOpacity=\"0.6\"\n            rx={FADER_WIDTH / 6}\n            stroke=\"var(--color-outline)\" />\n        <rect className=\"easel-fader-bg filled\"\n            fill={color}\n            height={FADER_HEIGHT - offset}\n            width={FADER_WIDTH / 3}\n            x={FADER_WIDTH / 3}\n            y={offset}\n            rx={FADER_WIDTH / 6}\n            stroke=\"var(--color-outline)\" />\n        <circle className=\"easel-fader-handle\"\n            fill={color}\n            r={HANDLE_WIDTH}\n            cx={FADER_WIDTH / 3 + FADER_WIDTH / 6}\n            cy={offset}\n            stroke=\"var(--color-outline)\" />\n        <rect width={FADER_WIDTH} height={FADER_HEIGHT} x=\"0\" y=\"0\" opacity=\"0\" />\n        {label && <LabelText text={label} x={FADER_WIDTH / 2} y={FADER_HEIGHT + 50} anchor=\"middle\"/>}\n    </g>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        value: (state.patch as any)[ownProps.module]?.[ownProps.fader],\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchUpdateFader,\n};\n\nexport const FaderView = connect(mapStateToProps, mapDispatchToProps)(FaderViewImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { getReadableName } from \"../midiMessages\";\nimport { dispatchUpdateFader } from \"../store/dispatch\";\nimport { State } from \"../store/reducer\";\nimport { toSVGCoordinate } from \"../util\";\n\nexport interface KnobProps {\n    color: string;\n    x: number;\n    y: number;\n    value: number;\n    module: string;\n    fader: string;\n    onChange?: (value: number) => void;\n\n    dispatchUpdateFader: (module: string, param: string, value: number) => void;\n}\n\nconst MAX_VALUE = 0x7ff;\nconst KNOB_RADIUS = 25;\nconst KNOB_THICKNESS = 18;\n\nexport const KnobImpl = (props: KnobProps) => {\n    const { color, x, y, value, module, fader, dispatchUpdateFader } = props;\n\n    const minAngle = 135 * Math.PI / 180;\n    const maxAngle = 405 * Math.PI / 180;\n    const angle = minAngle + (value / MAX_VALUE) * (maxAngle - minAngle);\n\n    const attachEvents = (g: SVGGElement) => {\n        if (!g) return;\n        if (window.PointerEvent) {\n            const pointerUpdate = (e: PointerEvent) => {\n                if (!e.buttons) return;\n                const rect = g.getBoundingClientRect();\n\n                const eventPoint = toSVGCoordinate(g.ownerSVGElement!, e.clientX, e.clientY);\n                const rectPoint = toSVGCoordinate(g.ownerSVGElement!, rect.left + rect.width / 2, rect.top + rect.height / 2)\n                let angle = Math.atan2(eventPoint.y - rectPoint.y, eventPoint.x - rectPoint.x);\n                if (angle < minAngle) {\n                    angle += Math.PI * 2\n                }\n                else if (angle > maxAngle) {\n                    angle -= Math.PI * 2\n                }\n\n                if (angle < minAngle || angle > maxAngle) return;\n\n                dispatchUpdateFader(module, fader, Math.min(MAX_VALUE, Math.max(0, (((angle - minAngle) / (maxAngle - minAngle)) * MAX_VALUE)) | 0));\n            }\n\n            let frameRef: number | undefined = undefined;;\n\n            const throttled = (e: PointerEvent) => {\n                if (frameRef) cancelAnimationFrame(frameRef);\n                frameRef = requestAnimationFrame(() => {\n                    frameRef = undefined;\n                    pointerUpdate(e);\n                })\n            }\n\n            g.addEventListener(\"pointerdown\", throttled);\n            g.addEventListener(\"pointermove\", throttled);\n        }\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent) => {\n        if (e.key === \"ArrowUp\" || e.key === \"ArrowRight\" || e.key === \"PageUp\") {\n            dispatchUpdateFader(module, fader, Math.min(value + 100, MAX_VALUE));\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"ArrowDown\" || e.key === \"ArrowLeft\" || e.key === \"PageDown\") {\n            dispatchUpdateFader(module, fader, Math.max(value - 100, 0));\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"End\") {\n            dispatchUpdateFader(module, fader, MAX_VALUE);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"Home\") {\n            dispatchUpdateFader(module, fader, 0);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    const innerArcFlag = angle - minAngle < Math.PI ? \"0\" : \"1\";\n\n    return <g\n        className=\"easel-knob\"\n        transform={`translate(${x}, ${y})`}\n        ref={attachEvents}\n        tabIndex={0}\n        role=\"slider\"\n        aria-valuemin={0}\n        aria-valuemax={MAX_VALUE}\n        aria-valuenow={value}\n        aria-label={getReadableName(module, fader)}\n        onKeyDown={onKeyDown}>\n        <path\n            className=\"knob-bg-outline\"\n            d={`M ${Math.cos(minAngle) * KNOB_RADIUS} ${Math.sin(minAngle) * KNOB_RADIUS} A ${KNOB_RADIUS} ${KNOB_RADIUS} 0 1 1 ${Math.cos(maxAngle) * KNOB_RADIUS} ${Math.sin(maxAngle) * KNOB_RADIUS}`}\n            stroke=\"var(--color-outline)\"\n            fill=\"none\"\n            strokeLinecap=\"round\"\n            strokeWidth={KNOB_THICKNESS + 2}\n        />\n        <path\n            className=\"knob-bg\"\n            d={`M ${Math.cos(minAngle) * KNOB_RADIUS} ${Math.sin(minAngle) * KNOB_RADIUS} A ${KNOB_RADIUS} ${KNOB_RADIUS} 0 1 1 ${Math.cos(maxAngle) * KNOB_RADIUS} ${Math.sin(maxAngle) * KNOB_RADIUS}`}\n            stroke=\"var(--color-switch-bg)\"\n            fill=\"none\"\n            strokeLinecap=\"round\"\n            strokeWidth={KNOB_THICKNESS}\n        />\n        <path\n            className=\"knob-fg-outline\"\n            d={`M ${Math.cos(minAngle) * KNOB_RADIUS} ${Math.sin(minAngle) * KNOB_RADIUS} A ${KNOB_RADIUS} ${KNOB_RADIUS} 0 ${innerArcFlag} 1 ${Math.cos(angle) * KNOB_RADIUS} ${Math.sin(angle) * KNOB_RADIUS}`}\n            stroke=\"var(--color-outline)\"\n            fill=\"none\"\n            strokeLinecap=\"round\"\n            strokeWidth={KNOB_THICKNESS - 2}\n        />\n        <path\n            className=\"knob-fg\"\n            d={`M ${Math.cos(minAngle) * KNOB_RADIUS} ${Math.sin(minAngle) * KNOB_RADIUS} A ${KNOB_RADIUS} ${KNOB_RADIUS} 0 ${innerArcFlag} 1 ${Math.cos(angle) * KNOB_RADIUS} ${Math.sin(angle) * KNOB_RADIUS}`}\n            stroke={color}\n            fill=\"none\"\n            strokeLinecap=\"round\"\n            strokeWidth={KNOB_THICKNESS - 4}\n        />\n        <rect width={KNOB_RADIUS * 2} height={KNOB_RADIUS * 2} x={-KNOB_RADIUS} y={-KNOB_RADIUS} opacity=\"0\" />\n    </g>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        value: (state.patch as any)[ownProps.module]?.[ownProps.fader],\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchUpdateFader,\n};\n\nexport const Knob = connect(mapStateToProps, mapDispatchToProps)(KnobImpl);","import * as React from \"react\";\nimport { LabelText } from \"./labelText\";\n\nexport interface SectionProps {\n    width: number;\n    height: number;\n    left: number;\n    top: number;\n    label?: string;\n    fill?: string;\n}\n\nexport const Section = (props: React.PropsWithChildren<SectionProps>) => {\n    const { width, height, left, top, label, fill, children } = props;\n\n    return <g className=\"section\" transform={`translate(${left}, ${top})`}>\n        <rect\n            x={0} y={0}\n            width={width}\n            height={height}\n            strokeWidth={1}\n            fill={fill || \"none\"}\n            stroke=\"var(--color-outline)\"/>\n        {children}\n        {label && <LabelText x={width / 2} y={height - 10} text={label} anchor=\"middle\"/>}\n    </g>\n}","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { dispatchUpdateSwitch } from \"../store/dispatch\";\nimport { State } from \"../store/reducer\";\n\nimport { SwitchValue } from \"../types\";\nimport { LabelText } from \"./labelText\";\n\nexport interface ToggleSwitchProps {\n    color: string;\n    top: number;\n    left: number;\n\n    topOption?: string;\n    middleOption?: string\n    bottomOption?: string;\n\n    module: string;\n    param: string;\n    twoWay?: boolean;\n\n    value: SwitchValue;\n    onChange: (value: SwitchValue) => void;\n\n\n    dispatchUpdateSwitch: (module: string, param: string, value: SwitchValue) => void;\n}\n\nconst TOGGLE_HEIGHT = 50;\nconst TOGGLE_WIDTH = 20;\nconst TOGGLE_HANDLE_RADIUS_RATIO = 0.75;\n\n\nexport const ToggleSwitchImpl = (props: ToggleSwitchProps) => {\n    const { color, left, top, value, topOption, middleOption, bottomOption, module, param, twoWay, onChange, dispatchUpdateSwitch } = props;\n\n    let cy = TOGGLE_WIDTH / 2;\n\n    if (value === \"middle\") {\n        cy = TOGGLE_HEIGHT / 2;\n    }\n    else if (value === \"bottom\") {\n        cy = TOGGLE_HEIGHT - (TOGGLE_WIDTH / 2);\n    }\n\n    const onClick = (e?: React.MouseEvent) => {\n        e?.preventDefault();\n        e?.stopPropagation();\n        switch (value) {\n            case \"bottom\": return dispatchUpdateSwitch(module, param, \"top\");\n            case \"middle\": return dispatchUpdateSwitch(module, param, \"bottom\");\n            case \"top\": return dispatchUpdateSwitch(module, param, twoWay ? \"bottom\" : \"middle\");\n        }\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent<SVGGElement>) => {\n        const charCode = (typeof e.which == \"number\") ? e.which : e.keyCode;\n        if (charCode === 13 /* enter */ || charCode === 32 /* space */) {\n            e.preventDefault();\n            onClick()\n        }\n    }\n\n\n    return <g\n        className=\"easel-toggle\"\n        transform={`translate(${left}, ${top})`}\n        onClick={onClick}\n        onKeyDown={onKeyDown}\n        tabIndex={0}>\n        <rect className=\"easel-toggle-bg\"\n            fill=\"var(--color-switch-bg)\"\n            height={TOGGLE_HEIGHT}\n            width={TOGGLE_WIDTH}\n            rx={TOGGLE_WIDTH / 2}\n            stroke=\"var(--color-outline)\"\n            x={0}\n            y={0} />\n        <circle\n            cx={TOGGLE_WIDTH / 2}\n            cy={cy}\n            r={TOGGLE_HANDLE_RADIUS_RATIO * TOGGLE_WIDTH / 2}\n            fill={color}\n            stroke=\"var(--color-outline)\"\n            />\n        {topOption &&\n            <LabelText\n                x={TOGGLE_WIDTH + 15}\n                y={TOGGLE_WIDTH / 2}\n                text={topOption}\n                alignment=\"middle\"\n                />\n        }\n        {middleOption &&\n            <LabelText\n                x={TOGGLE_WIDTH + 15}\n                y={(TOGGLE_HEIGHT / 2)}\n                text={middleOption}\n                alignment=\"middle\"\n                />\n        }\n        {bottomOption &&\n            <LabelText\n                x={TOGGLE_WIDTH + 15}\n                y={TOGGLE_HEIGHT - TOGGLE_WIDTH / 2}\n                text={bottomOption}\n                alignment=\"middle\"\n                />\n        }\n    </g>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        value: (state.patch as any)[ownProps.module]?.[ownProps.param],\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchUpdateSwitch,\n};\n\nexport const ToggleSwitch = connect(mapStateToProps, mapDispatchToProps)(ToggleSwitchImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { dispatchUpdateFader, dispatchUpdateSwitch } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { ComplexOscillator } from \"../../types\";\nimport { FaderView } from \"../fader\";\nimport { Knob } from \"../knob\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface ComplexOscillatorViewProps extends ComplexOscillator {\n}\n\nexport const ComplexOscillatorViewImpl = (props: ComplexOscillatorViewProps) => {\n    const {\n        pitch,\n        pitchCV,\n        polarity,\n        keyboard,\n        timbre,\n        timbreCV,\n        timbreKnob,\n        waveshape\n    } = props;\n    return <Section left={970} top={120} width={305} height={500}>\n        <Section left={0} top={0} width={305} height={30} label=\"COMPLEX OSCILLATOR\" />\n        <Section left={0} top={30} width={175} height={85} label=\"keyboard\">\n            <ToggleSwitch\n                color=\"var(--color-complex-oscillator)\"\n                top={5}\n                left={32}\n\n                topOption=\"on\"\n                bottomOption=\"off\"\n\n                value={keyboard}\n                twoWay={true}\n                module={\"complexOsc\"} param={\"keyboard\"}\n            />\n        </Section>\n        <Section left={0} top={115} width={175} height={85} label=\"polarity\">\n            <ToggleSwitch\n                color=\"var(--color-complex-oscillator)\"\n                top={5}\n                left={32}\n\n                topOption=\"-\"\n                bottomOption=\"+\"\n\n                value={polarity}\n                twoWay={true}\n                module={\"complexOsc\"} param={\"polarity\"}\n            />\n        </Section>\n        <Section left={175} top={30} width={130} height={170} label=\"timbre\">\n            <Knob\n                x={65}\n                y={45}\n                value={timbreKnob}\n                color=\"var(--color-complex-oscillator)\"\n                module={\"complexOsc\"}\n                fader={\"timbreKnob\"} \n            />\n            <ToggleSwitch\n                color=\"var(--color-complex-oscillator)\"\n                top={90}\n                left={20}\n\n                value={waveshape}\n                module={\"complexOsc\"} param={\"waveshape\"}\n            />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 95 m 0 10 l 20 -10 l 0 10 l 20 -10 l 0 10 l 20 -10 l 0 10\" />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 110 m 0 10 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10\" />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 125 m 0 10 l 10 -10 l 10 10 l 10 -10 l 10 10 l 10 -10 l 10 10\" />\n        </Section>\n        <Section left={0} top={200} width={305} height={300}>\n            <FaderView left={30} top={20} value={pitchCV} color=\"var(--color-complex-oscillator)\" module={\"complexOsc\"} fader={\"pitchCV\"} />\n            <FaderView left={105} top={20} value={pitch} color=\"var(--color-complex-oscillator)\" label=\"pitch\" module={\"complexOsc\"} fader={\"pitch\"}/>\n            <FaderView left={180} top={20} value={timbreCV} color=\"var(--color-complex-oscillator)\" module={\"complexOsc\"} fader={\"timbreCV\"}/>\n            <FaderView left={255} top={20} value={timbre} color=\"var(--color-complex-oscillator)\" label=\"timbre\" module={\"complexOsc\"} fader={\"timbre\"}/>\n        </Section>\n    </Section>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...state.patch.complexOsc\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchUpdateFader,\n    dispatchUpdateSwitch\n};\n\nexport const ComplexOscillatorView = connect(mapStateToProps, mapDispatchToProps)(ComplexOscillatorViewImpl);","import { Easel } from \"./types\";\nimport { encodePatch } from \"./util\";\n\nconst PATCH_DB_NAME = \"PATCH_DB\";\nlet _db: IDBDatabase;\nlet openPromise: Promise<IDBDatabase>;\n\nexport interface SavedPatch {\n    name: string;\n    patch: string;\n    createdTime: number;\n    lastSavedTime: number;\n\n    // id is populated by the db\n    id?: number;\n    preview?: string;\n}\n\nasync function initDBAsync() {\n    if (_db) return _db;\n\n    if (!openPromise) {\n        openPromise = new Promise((resolve, reject) => {\n\n            const request = indexedDB.open(PATCH_DB_NAME, 2);\n        \n            request.onerror = event => {\n                reject();\n            };\n        \n            request.onupgradeneeded = event => {\n                const db = request.result;\n                const objectStore = db.createObjectStore(\n                    \"patches\", \n                    {\n                        autoIncrement: true,\n                        keyPath: \"id\"\n                    }\n                );\n                objectStore.createIndex(\"name\", \"name\", { unique: false });\n                objectStore.createIndex(\"patch\", \"patch\", { unique: false });\n                objectStore.createIndex(\"preview\", \"preview\", { unique: false });\n                objectStore.createIndex(\"createdTime\", \"createdTime\", { unique: false });\n                objectStore.createIndex(\"lastSavedTime\", \"lastSavedTime\", { unique: false });\n            };\n        \n            request.onsuccess = event => {\n                _db = request.result;\n                resolve(_db);\n            }\n        });\n    }\n    \n    return openPromise;\n}\n\nasync function lookupEntryAsync(id: number): Promise<SavedPatch | undefined> {\n    const db = await initDBAsync();\n\n    return new Promise((resolve, reject) => {\n        const transaction = db.transaction([\"patches\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"patches\");\n        const request = objectStore.get(id) as IDBRequest<SavedPatch>;\n        request.onerror = event => {\n            reject();\n        };\n        request.onsuccess = event => {\n            resolve(request.result);\n        };\n    })\n}\n\nasync function addEntryAsync(entry: SavedPatch): Promise<SavedPatch> {\n    const db = await initDBAsync();\n\n    return new Promise<SavedPatch>((resolve, reject) => {\n        const transaction = db.transaction([\"patches\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"patches\");\n        const request = objectStore.add(entry);\n        request.onerror = event => {\n            reject();\n        };\n        request.onsuccess = event => {\n            resolve({\n                ...entry,\n                id: request.result as number\n            })\n        };\n    })\n}\n\nasync function updateEntryAsync(entry: SavedPatch): Promise<SavedPatch> {\n    const db = await initDBAsync();\n\n    return new Promise((resolve, reject) => {\n        const transaction = db.transaction([\"patches\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"patches\");\n        const toStore = {\n            ...entry,\n            lastSavedTime: Date.now()\n        };\n        const request = objectStore.put(toStore);\n        request.onerror = event => {\n            reject();\n        };\n        request.onsuccess = event => {\n            resolve({\n                ...toStore,\n                id: request.result as number\n            });\n        };\n    })\n}\n\nasync function listEntriesAsync(): Promise<SavedPatch[]> {\n    const db = await initDBAsync();\n\n    return new Promise((resolve, reject) => {\n        const transaction = db.transaction([\"patches\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"patches\");\n        const request = objectStore.openCursor();\n\n        const allEntries: SavedPatch[] = [];\n\n        request.onerror = event => {\n            reject();\n        }\n\n        request.onsuccess = event => {\n            const cursor = request.result;\n\n            if (cursor) {\n                allEntries.push(cursor.value)\n                cursor.continue();\n            }\n            else {\n                resolve(allEntries);\n            }\n        }\n    })\n} \n\nexport async function savePatchAsync(name: string, patch: Easel, preview?: string) {\n    const entry = {\n        name,\n        patch: encodePatch(patch),\n        preview,\n        createdTime: Date.now(),\n        lastSavedTime: Date.now()\n    };\n\n    return await addEntryAsync(entry);\n}\n\nexport async function updatePatchAsync(entry: SavedPatch) {\n    return await updateEntryAsync(entry);\n}\n\nexport async function getPatchAsync(id: number): Promise<SavedPatch | undefined> {\n    return await lookupEntryAsync(id);\n}\n\nexport async function allPatchesAsync(): Promise<SavedPatch[]> {\n    return await listEntriesAsync();\n}","import * as React from \"react\";\nimport { FaderView } from \"../fader\";\nimport { LabelText } from \"../labelText\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface DualLoPassGatesProps {\n\n}\n\nexport const DualLoPassGates = (props: DualLoPassGatesProps) => {\n    return <Section left={1275} top={120} width={300} height={500}>\n        <Section left={0} top={0} width={300} height={30} label=\"DUAL LO PASS GATE\" />\n        <Section left={0} top={30} width={300} height={85} label=\"gate 2 source\">\n\n        <ToggleSwitch\n                color=\"var(--color-dual-lo-pass-gate)\"\n                top={5}\n                left={85}\n\n                topOption=\"aux in\"\n                middleOption=\"mod oscillator\"\n                bottomOption=\"gate 1\"\n\n                module={\"gates\"} param={\"gate2Source\"}\n            />\n        </Section>\n        <Section left={0} top={115} width={300} height={85} label=\"mode select\">\n            <ToggleSwitch\n                color=\"var(--color-dual-lo-pass-gate)\"\n                top={5}\n                left={35}\n                label=\"gate 1\"\n\n                module={\"gates\"} param={\"gate1Mode\"}\n            />\n\n            <ToggleSwitch\n                color=\"var(--color-dual-lo-pass-gate)\"\n                top={5}\n                left={245}\n                label=\"gate 2\"\n\n                module={\"gates\"} param={\"gate2Mode\"}\n            />\n\n            <LabelText\n                x={150}\n                y={15}\n                text={\"lopass filter\"}\n                anchor=\"middle\"\n                alignment=\"middle\"\n                />\n\n            <LabelText\n                x={150}\n                y={30}\n                text={\"combination\"}\n                anchor=\"middle\"\n                alignment=\"middle\"\n                />\n\n            <LabelText\n                x={150}\n                y={45}\n                text={\"voltage controlled amp\"}\n                anchor=\"middle\"\n                alignment=\"middle\"\n                />\n        </Section>\n        <Section left={0} top={200} width={300} height={300}>\n            <FaderView left={30} top={20} value={0} color=\"var(--color-dual-lo-pass-gate)\" module={\"gates\"} fader={\"level1CV\"}/>\n            <FaderView left={105} top={20} value={0} color=\"var(--color-dual-lo-pass-gate)\" label=\"gate 1\" module={\"gates\"} fader={\"level1\"}/>\n            <FaderView left={180} top={20} value={0} color=\"var(--color-dual-lo-pass-gate)\" module={\"gates\"} fader={\"level2CV\"}/>\n            <FaderView left={255} top={20} value={0} color=\"var(--color-dual-lo-pass-gate)\" label=\"gate 2\" module={\"gates\"} fader={\"level2\"}/>\n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport { FaderView } from \"../fader\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface EnvelopeGeneratorProps {\n\n}\n\nexport const EnvelopeGenerator = (props: EnvelopeGeneratorProps) => {\n    return <Section left={315} top={120} width={200} height={500}>\n        <Section left={0} top={0} width={200} height={30} label=\"ENVELOPE GENERATOR\" />\n        <Section left={0} top={30} width={200} height={85} label=\"trigger select\">\n            <ToggleSwitch\n                color=\"var(--color-envelope-generator)\"\n                top={5}\n                left={35}\n\n                topOption=\"keyboard\"\n                middleOption=\"pulser\"\n                bottomOption=\"sequencer\"\n\n                module={\"envelope\"} param={\"triggerSelect\"}\n            />\n        </Section>\n        <Section left={0} top={115} width={200} height={85} label=\"mode select\">\n            <ToggleSwitch\n                color=\"var(--color-envelope-generator)\"\n                top={5}\n                left={35}\n\n                topOption=\"sustained\"\n                middleOption=\"transient\"\n                bottomOption=\"self\"\n\n                module={\"envelope\"} param={\"modeSelect\"}\n            />\n        </Section>\n        <Section left={0} top={200} width={200} height={300}>\n            <FaderView left={25} top={20} value={0} color=\"var(--color-envelope-generator)\" label=\"attack\" module={\"envelope\"} fader={\"attack\"}/>\n            <FaderView left={90} top={20} value={0} color=\"var(--color-envelope-generator)\" label=\"sustain\" module={\"envelope\"} fader={\"sustain\"}/>\n            <FaderView left={155} top={20} value={0} color=\"var(--color-envelope-generator)\" label=\"decay\" module={\"envelope\"} fader={\"decay\"}/>\n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport { FaderView } from \"../fader\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface ModulationOscillatorProps {\n\n}\n\nexport const ModulationOscillator = (props: ModulationOscillatorProps) => {\n    return <Section left={665} top={120} width={305} height={500}>\n        <Section left={0} top={0} width={305} height={30} label=\"MODULATION OSCILLATOR\" />\n        <Section left={0} top={30} width={175} height={85} label=\"keyboard\">\n            <ToggleSwitch\n                color=\"var(--color-modulation-oscillator)\"\n                top={5}\n                left={32}\n\n                topOption=\"on\"\n                bottomOption=\"off\"\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"modOsc\"} param={\"keyboard\"}\n            />\n        </Section>\n        <Section left={175} top={30} width={130} height={85} label=\"waveshape\">\n            <ToggleSwitch\n                color=\"var(--color-modulation-oscillator)\"\n                top={5}\n                left={20}\n\n                value={\"top\"}\n                module={\"modOsc\"} param={\"waveshape\"}\n            />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 10 m 0 10 l 20 -10 l 0 10 l 20 -10 l 0 10 l 20 -10 l 0 10\" />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 25 m 0 10 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10 l 10 0 l 0 10 l 10 0 l 0 -10\" />\n            <path className=\"wave-path\" stroke=\"var(--color-outline)\" strokeWidth=\"1\" fill=\"none\" d=\"m 55 40 m 0 10 l 10 -10 l 10 10 l 10 -10 l 10 10 l 10 -10 l 10 10\" />\n        </Section>\n        <Section left={0} top={115} width={175} height={85} label=\"range\">\n            <ToggleSwitch\n                color=\"var(--color-modulation-oscillator)\"\n                top={5}\n                left={32}\n\n                topOption=\"high\"\n                bottomOption=\"low\"\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"modOsc\"} param={\"range\"}\n            />\n        </Section>\n        <Section left={175} top={115} width={130} height={85} label=\"modulation\">\n            <ToggleSwitch\n                color=\"var(--color-modulation-oscillator)\"\n                top={5}\n                left={20}\n\n                topOption=\"bal. ext\"\n                middleOption=\"a.m. osc.\"\n                bottomOption=\"f.m. osc.\"\n\n                value={\"top\"}\n                module={\"modOsc\"} param={\"modulationType\"}\n            />\n        </Section>\n        <Section left={0} top={200} width={305} height={300}>\n            <FaderView left={30} top={20} value={0} color=\"var(--color-modulation-oscillator)\" module={\"modOsc\"} fader={\"frequencyCV\"}/>\n            <FaderView left={105} top={20} value={0} color=\"var(--color-modulation-oscillator)\" label=\"frequency\" module={\"modOsc\"} fader={\"frequency\"}/>\n            <FaderView left={180} top={20} value={0} color=\"var(--color-modulation-oscillator)\" module={\"modOsc\"} fader={\"modulationCV\"}/>\n            <FaderView left={255} top={20} value={0} color=\"var(--color-modulation-oscillator)\" label=\"modulation\" module={\"modOsc\"} fader={\"modulation\"}/>\n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport { Jack, ConnectionPoint } from \"../jack\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface PatchbayProps {\n\n}\n\nexport const Patchbay = (props: PatchbayProps) => {\n    return <Section left={0} top={620} width={1575} height={120}>\n        <Section left={0} top={0} width={180} height={120}>\n            <Section left={0} top={0} width={180} height={30} label=\"KEYBOARD OUTPUT\" />\n            <Jack\n                x={30}\n                y={65}\n                color=\"var(--color-keyboard-pulse)\"\n                connectionPoint={ConnectionPoint.PulseOutput}\n                text=\"pulse\" />\n            <Jack\n                x={90}\n                y={65}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.PressureOutput}\n                id={0}\n                text=\"pressure\" />\n            <Jack\n                x={150}\n                y={65}\n                color=\"var(--color-keyboard-pitch)\"\n                connectionPoint={ConnectionPoint.PitchOutput}\n                text=\"pitch\" />\n        </Section>\n        <Section left={180} top={0} width={135} height={120}>\n            <Section left={0} top={0} width={135} height={30} label=\"RANDOM VOLTAGE\" />\n\n            <Section left={0} top={30} width={135} height={90} label=\"trigger source\">\n                <ToggleSwitch\n                    color=\"var(--color-random-voltage)\"\n                    top={5}\n                    left={23}\n\n                    topOption=\"keyboard\"\n                    middleOption=\"pulser\"\n                    bottomOption=\"sequencer\"\n\n                    value={\"top\"}\n                    module={\"random\"} param={\"triggerSource\"}\n                />\n            </Section>\n        </Section>\n        <Section left={315} top={0} width={1260} height={120}>\n            <Jack\n                x={32}\n                y={30}\n                color=\"var(--color-input)\"\n                connectionPoint={ConnectionPoint.EnvelopeAttackInput}\n                arrow=\"short\"\n                id={0} />\n            <Jack\n                x={32}\n                y={90}\n                color=\"var(--color-sequencer)\"\n                connectionPoint={ConnectionPoint.SequentialVoltageOutput}\n                id={0} />\n            <Jack\n                x={97}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"medium\"\n                connectionPoint={ConnectionPoint.EnvelopeSustainInput}\n                id={0} />\n            <Jack\n                x={163}\n                y={30}\n                color=\"var(--color-input)\"\n                arrow=\"short\"\n                connectionPoint={ConnectionPoint.EnvelopeDecayInput}\n                id={0} />\n            <Jack\n                x={163}\n                y={90}\n                color=\"var(--color-random-voltage)\"\n                connectionPoint={ConnectionPoint.RandomOutput}\n                id={0} />\n            <Jack\n                x={239}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.PulserPeriodInput}\n                id={0} />\n\n            <Jack\n                x={313}\n                y={30}\n                color=\"var(--color-envelope-generator)\"\n                connectionPoint={ConnectionPoint.EnvelopeGeneratorOutput}\n                id={0} />\n            <Jack\n                x={313}\n                y={90}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.PressureOutput}\n                id={1} />\n            <Jack\n                x={388}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.ModulationOscFrequencyInput} />\n\n\n            <Jack\n                x={463}\n                y={30}\n                color=\"var(--color-pulser)\"\n                connectionPoint={ConnectionPoint.PulserOutput}\n                id={1} />\n            <Jack\n                x={463}\n                y={90}\n                color=\"var(--color-random-voltage)\"\n                connectionPoint={ConnectionPoint.RandomOutput}\n                id={1} />\n            <Jack\n                x={538}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.ModulationOscModulationInput} />\n\n\n            <Jack\n                x={613}\n                y={30}\n                color=\"var(--color-sequencer)\"\n                connectionPoint={ConnectionPoint.SequentialVoltageOutput}\n                id={1} />\n            <Jack\n                x={613}\n                y={90}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.PressureOutput}\n                id={2} />\n            <Jack\n                x={693}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.ComplexOscPitchInput} />\n\n\n            <Jack\n                x={768}\n                y={30}\n                color=\"var(--color-envelope-generator)\"\n                connectionPoint={ConnectionPoint.EnvelopeGeneratorOutput}\n                id={1} />\n            <Jack\n                x={768}\n                y={90}\n                color=\"var(--color-random-voltage)\"\n                connectionPoint={ConnectionPoint.RandomOutput}\n                id={2} />\n            <Jack\n                x={843}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.ComplexOscTimbreInput} />\n\n            <Jack\n                x={918}\n                y={30}\n                color=\"var(--color-pulser)\"\n                connectionPoint={ConnectionPoint.PulserOutput}\n                id={2} />\n            <Jack\n                x={918}\n                y={90}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.PressureOutput}\n                id={3} />\n            <Jack\n                x={998}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.LoPassGate1Input} />\n            \n            <Jack\n                x={1073}\n                y={30}\n                color=\"var(--color-envelope-generator)\"\n                connectionPoint={ConnectionPoint.EnvelopeGeneratorOutput}\n                id={2} />\n            <Jack\n                x={1073}\n                y={90}\n                color=\"var(--color-random-voltage)\"\n                connectionPoint={ConnectionPoint.RandomOutput}\n                id={3} />\n            <Jack\n                x={1148}\n                y={60}\n                color=\"var(--color-input)\"\n                arrow=\"long\"\n                connectionPoint={ConnectionPoint.LoPassGate2Input} />\n        \n            <Jack\n                x={1223}\n                y={30}\n                color=\"var(--color-pulser)\"\n                connectionPoint={ConnectionPoint.PulserOutput}\n                id={3} />\n            <Jack\n                x={1223}\n                y={90}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.PressureOutput}\n                id={4} />\n            \n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport { FaderView } from \"../fader\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface PulserProps {\n\n}\n\nexport const Pulser = (props: PulserProps) => {\n    return <Section left={515} top={120} width={150} height={500}>\n        <Section left={0} top={0} width={150} height={30} label=\"PULSER\" />\n        <Section left={0} top={30} width={150} height={85} label=\"trigger select\">\n            <ToggleSwitch\n                color=\"var(--color-pulser)\"\n                top={5}\n                left={32}\n\n                topOption=\"keyboard\"\n                middleOption=\"self\"\n                bottomOption=\"sequencer\"\n\n                value={\"top\"}\n                module={\"pulser\"} param={\"triggerSelect\"}\n            />\n        </Section>\n        <Section left={0} top={115} width={150} height={85} label=\"mode\">\n            <ToggleSwitch\n                color=\"var(--color-pulser)\"\n                top={5}\n                left={32}\n\n                topOption=\"triggered\"\n                middleOption=\"off\"\n                bottomOption=\"once\"\n\n                value={\"top\"}\n                module={\"pulser\"} param={\"modeSelect\"}\n            />\n        </Section>\n        <Section left={0} top={200} width={150} height={300}>\n            <FaderView left={30} top={20} value={0} color=\"var(--color-pulser)\" module={\"pulser\"} fader={\"periodCV\"}/>\n            <FaderView left={105} top={20} value={0} color=\"var(--color-pulser)\" label=\"period\" module={\"pulser\"} fader={\"period\"}/>\n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport { FaderView } from \"../fader\";\nimport { LabelText } from \"../labelText\";\nimport { Section } from \"../section\";\nimport { ToggleSwitch } from \"../toggleSwitch\";\n\nexport interface SequencerProps {\n\n}\n\nexport const Sequencer = (props: SequencerProps) => {\n    return <Section left={0} top={120} width={315} height={500}>\n        <Section left={0} top={0} width={315} height={30} label=\"SEQUENTIAL VOLTAGE SOURCE\" />\n        <Section left={0} top={30} width={175} height={85} label=\"trigger select\">\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={35}\n\n                topOption=\"keyboard\"\n                middleOption=\"pulser\"\n                bottomOption=\"off\"\n\n                value={\"top\"}\n                module={\"sequencer\"} param={\"triggerSelect\"}\n            />\n        </Section>\n        <Section left={175} top={30} width={140} height={85} label=\"stages\">\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={40}\n\n                topOption=\"3\"\n                middleOption=\"4\"\n                bottomOption=\"5\"\n\n                value={\"top\"}\n                module={\"sequencer\"} param={\"stages\"}\n            />\n        </Section>\n        <Section left={0} top={115} width={315} height={85} label=\"pulse sequence\">\n            <LabelText x={25} y={20} text=\"1\" />\n            <LabelText x={80} y={20} text=\"2\" />\n            <LabelText x={135} y={20} text=\"3\" />\n            <LabelText x={190} y={20} text=\"4\" />\n            <LabelText x={245} y={20} text=\"5\" />\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={42}\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"sequencer\"} param={\"pulse1\"}\n            />\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={97}\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"sequencer\"} param={\"pulse2\"}\n            />\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={152}\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"sequencer\"} param={\"pulse3\"}\n            />\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={207}\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"sequencer\"} param={\"pulse4\"}\n            />\n            <ToggleSwitch\n                color=\"var(--color-sequencer)\"\n                top={5}\n                left={262}\n\n                value={\"top\"}\n                twoWay={true}\n                module={\"sequencer\"} param={\"pulse5\"}\n            />\n        </Section>\n        <Section left={0} top={200} width={315} height={300} label=\"sequencer voltage levels\">\n            <FaderView left={52} top={20} value={800} color=\"var(--color-sequencer)\" module={\"sequencer\"} fader={\"voltage1\"}/>\n            <FaderView left={107} top={20} value={1500} color=\"var(--color-sequencer)\" module={\"sequencer\"} fader={\"voltage2\"}/>\n            <FaderView left={162} top={20} value={2500} color=\"var(--color-sequencer)\" module={\"sequencer\"} fader={\"voltage3\"}/>\n            <FaderView left={217} top={20} value={0} color=\"var(--color-sequencer)\" module={\"sequencer\"} fader={\"voltage4\"}/>\n            <FaderView left={272} top={20} value={0} color=\"var(--color-sequencer)\" module={\"sequencer\"} fader={\"voltage5\"}/>\n        </Section>\n    </Section>\n}","import * as React from \"react\";\nimport '../styles/iconButton.css';\n\n\nexport interface IconButtonProps {\n    left: number;\n    top: number;\n    title: string;\n    onClick: () => void;\n}\n\nconst ICON_BUTTON_WIDTH = 60;\n\nexport const IconButton = (props: React.PropsWithChildren<IconButtonProps>) => {\n    const { children, left, top, title, onClick } = props;\n    \n    const onKeydown = (ev: React.KeyboardEvent<SVGGElement>) => {\n        if (ev.key === \"Enter\") {\n            onClick();\n            ev.preventDefault();\n            ev.stopPropagation();\n        }\n    }\n\n    return <g\n        transform={`translate(${left} ${top})`}\n        className=\"icon-button\"\n        aria-label={title}\n        onClick={onClick}\n        onKeyDown={onKeydown}\n        tabIndex={0}\n        role=\"button\">\n        <rect\n            stroke=\"var(--color-outline)\"\n            width={ICON_BUTTON_WIDTH}\n            height={ICON_BUTTON_WIDTH}\n            fill=\"var(--color-background)\"\n            />\n            <g transform={`translate(${5} ${5})`}>\n                {children}\n            </g>\n    </g>\n}","\nexport const DownloadIcon = () =>\n<path\n    d=\"M 20 2.5 h 10 v 25 h 10 l -15 15 l -15 -15 h 10 v -25 z M 2.5 45 h 45 v 2.5 h -45 z\"     \n    stroke=\"var(--color-outline)\"\n    fill=\"var(--color-background)\" />","export const FolderIcon = () =>\n    <>\n        <path\n            d=\"M 5 7.5\n            a 2.5 2.5 1 0 0 -2.5 2.5\n            v 35\n            a 2.5 2.5 1 0 0 2.5 2.5\n            h 37.5\n            a 2.5 2.5 1 0 0 2.5 -2.5\n            v -30\n            a 2.5 2.5 1 0 0 -2.5 -2.5\n            h -20\n            a 2.5 2.5 1 0 1 -2.5 -2.5\n            a 2.5 2.5 1 0 0 -2.5 -2.5\n            z\"     \n            stroke=\"var(--color-outline)\"\n            fill=\"var(--color-background)\" />\n        <path\n            d=\"M 10 10\n            a 2.5 2.5 1 0 0 -2.5 2.5\n            l -5 32.5\n            a 2.5 2.5 1 0 0 2.5 2.5\n            h 37.5\n            a 2.5 2.5 1 0 0 2.5 -2.5\n            l 5 -27.5\n            a 2.5 2.5 1 0 0 -2.5 -2.5\n            h -20\n            a 2.5 2.5 1 0 1 -2.5 -2.5\n            a 2.5 2.5 1 0 0 -2.5 -2.5\n            z\"    \n            stroke=\"var(--color-outline)\"\n            fill=\"var(--color-background)\" />\n    </>","export const MidiIcon = () => <>\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"25\"\n        cy=\"25\"\n        r=\"22.5\"\n    />\n    <path\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        d=\"M 20 5 a 20.5 20.5 1 1 0 10 0 v 2.5 h -10 z\"\n    />\n\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"37.5\"\n        cy=\"25\"\n        r=\"2.5\"\n    />\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"33.83\"\n        cy=\"33.83\"\n        r=\"2.5\"\n    />\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"25\"\n        cy=\"37.5\"\n        r=\"2.5\"\n    />\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"16.16\"\n        cy=\"33.83\"\n        r=\"2.5\"\n    />\n    <circle\n        fill=\"var(--color-background)\"\n        stroke=\"var(--color-outline)\"\n        cx=\"12.5\"\n        cy=\"25\"\n        r=\"2.5\"\n    />\n</>","\nexport const SaveIcon = () =>\n    <path\n    d=\"M 7.5 2.5 a 5 5 1 0 0 -5 5 v 35 a 5 5 1 0 0 5 5 h 35 a 5 5 1 0 0 5 -5  v -32.5 l -7.5 -7.5 h -32.5 M 10 47.5 v -17.5 a 2.5 2.5 1 0 1 2.5 -2.5 h 25 a 2.5 2.5 1 0 1 2.5 2.5 v 17.5 M 12.5 2.5 v 15 h 25 v -15 M 35 5 v 10 h -7.5 v -10 h 7.75 M 12.5 30 h 25 v 2.5 h -25 v -2.75 M 12.5 35 h 25 v 2.5 h -25 v -2.75 M 12.5 40 h 25 v 2.5 h -25 v -2.75\"     \n    stroke=\"var(--color-outline)\"\n    fill=\"var(--color-background)\" />","import * as React from \"react\";\n\nimport '../styles/titleInput.css';\n\nexport interface TitleInputProps {\n    value: string;\n    left: number;\n    top: number;\n    onChange: (newValue: string) => void;\n    \n    width: number;\n    height: number;\n}\n\nexport const TitleInput = (props: TitleInputProps) => {\n    const { value, left, top, onChange, width, height } = props;\n    const [ currentValue, setCurrentValue ] = React.useState<string | undefined>();\n\n    const onInputChanged = (ev: React.ChangeEvent<HTMLInputElement>) => {\n        setCurrentValue(ev.currentTarget.value);\n    }\n\n    const onBlurEvent = (ev: React.FocusEvent<HTMLInputElement>) => {\n        if (currentValue) onChange(currentValue)\n        setCurrentValue(undefined);\n    }\n\n    const onKeydown = (ev: React.KeyboardEvent<HTMLInputElement>) => {\n        if (ev.key === \"Enter\") ev.currentTarget.blur();\n    }\n\n    return <g transform={`translate(${left} ${top})`} className=\"title-input\">\n        <rect\n            width={width}\n            height={height}\n            fill=\"none\"\n            stroke=\"var(--color-outline)\"\n            />\n        <foreignObject\n            width={width}\n            height={height}>\n            <input\n                type=\"text\"\n                value={currentValue == undefined ? value : currentValue}\n                onChange={onInputChanged}\n                onBlur={onBlurEvent}\n                onKeyDown={onKeydown}\n                />\n        </foreignObject>\n    </g>\n}","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { SavedPatch, savePatchAsync, updatePatchAsync } from \"../../indexedDB\";\nimport { dispatchSetPatchName, dispatchShowModal, dispatchOpenSavedPatch } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { Easel, ModalType } from \"../../types\";\nimport { createPreviewURI, encodePatch } from \"../../util\";\nimport { IconButton } from \"../iconButton\";\nimport { DownloadIcon } from \"../icons/downloadIcon\";\nimport { FolderIcon } from \"../icons/folderIcon\";\nimport { MidiIcon } from \"../icons/midiIcon\";\nimport { SaveIcon } from \"../icons/saveIcon\";\nimport { Jack, ConnectionPoint } from \"../jack\";\nimport { LabelText } from \"../labelText\";\nimport { Section } from \"../section\";\nimport { TitleInput } from \"../titleInput\";\n\nexport interface TopBarProps {\n    dispatchSetPatchName: (name: string) => void;\n    dispatchShowModal: (type: ModalType) => void;\n    dispatchOpenSavedPatch: (patch: SavedPatch) => void;\n    patchName: string;\n    saved?: SavedPatch;\n    patch: Easel;\n    patchNotSaved: boolean;\n}\n\nexport const TopBarImpl = (props: TopBarProps) => {\n    const { patchName, saved, patch, patchNotSaved, dispatchSetPatchName, dispatchShowModal, dispatchOpenSavedPatch } = props;\n\n    let svgRef: SVGSVGElement;\n    const handleRef = (ref: SVGGElement) => {\n        if (ref) svgRef = ref.ownerSVGElement!\n    }\n\n    const onSaveClicked = async () => {\n        let saveResult: SavedPatch;\n        if (saved) {\n            saveResult = await updatePatchAsync({\n                ...saved,\n                patch: encodePatch(patch),\n                preview: createPreviewURI(svgRef),\n                name: patchName\n            });\n        }\n        else {\n            saveResult = await savePatchAsync(patchName, patch, createPreviewURI(svgRef));\n        }\n\n        dispatchOpenSavedPatch(saveResult);\n    }\n\n\n    return <Section left={0} top={0} width={1575} height={120}>\n        <g ref={handleRef} />\n        <Section left={0} top={0} width={840} height={120}>\n            <Section left={0} top={0} width={840} height={30} label=\"EASEL PROGRAM MANAGER\" />\n            <IconButton\n                left={15}\n                top={45}\n                title=\"Saved Patches\"\n                onClick={() => dispatchShowModal(\"file\")}>\n                <FolderIcon />\n            </IconButton>\n            <IconButton\n                left={90}\n                top={45}\n                title=\"Save Patch\"\n                onClick={onSaveClicked}>\n                <SaveIcon />\n            </IconButton>\n            <IconButton\n                left={165}\n                top={45}\n                title=\"Send patch to easel\"\n                onClick={() => dispatchShowModal(\"download\")}>\n                <DownloadIcon />\n            </IconButton>\n            <IconButton\n                left={240}\n                top={45}\n                title=\"Midi Config\"\n                onClick={() => dispatchShowModal(\"midi\")}>\n                <MidiIcon />\n            </IconButton>\n            <TitleInput\n                left={315}\n                top={45}\n                height={60}\n                width={410}\n                onChange={dispatchSetPatchName}\n                value={patchName}\n                />\n            <Jack\n                x={785}\n                y={65}\n                color=\"var(--color-modulation-oscillator)\"\n                connectionPoint={ConnectionPoint.ModulationCVOutput}\n                text=\"mod cv out\" />\n        </Section>\n        <Section left={840} top={0} width={305} height={120}>-\n            <Section left={0} top={0} width={305} height={30} label=\"EXTERNAL CV\" />\n            <Jack\n                x={55}\n                y={65}\n                color=\"var(--color-input)\"\n                connectionPoint={ConnectionPoint.PanelInput}\n                text=\"to panel\" />\n            <Jack\n                x={152.5}\n                y={65}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.Panel1Output}\n                id={0}\n                text=\"from panel 1\" />\n            <Jack\n                x={250}\n                y={65}\n                color=\"var(--color-keyboard-pressure)\"\n                connectionPoint={ConnectionPoint.Panel2Output}\n                text=\"from panel 2\" />\n        </Section>\n        <Section left={1145} top={0} width={130} height={120}>-\n            <Section left={0} top={0} width={130} height={30} label=\"COMP OSC\" />\n            {/* <path \n                d=\"M 65 65 h 45 a 5 5 1 0 1 5 5 v 60 a 5 5 1 0 1 -5 5 h -40 a 5 5 1 0 0 -5 5 v 30\"\n                stroke=\"var(--color-outline)\"\n                strokeDasharray=\"3 3\"\n                fill=\"none\"\n            /> */}\n            <Jack\n                x={65}\n                y={65}\n                color=\"var(--color-input)\"\n                connectionPoint={ConnectionPoint.ComplexOscWaveshapeInput}\n                text=\"waveshape\" />\n        </Section>\n        <Section left={1275} top={0} width={300} height={120}>\n            <Section left={0} top={0} width={300} height={30} label=\"PRE AMP / ENVELOPE DETECTOR\" />\n            {patchNotSaved &&\n                <g transform=\"translate(15, 45)\">\n                    <LabelText className=\"big\" x={90} y={28} text=\"Patch not\" anchor=\"middle\" />\n                    <LabelText className=\"big\" x={90} y={50} text=\"saved!\" anchor=\"middle\" />\n                </g>\n            }\n            <Jack\n                x={250}\n                y={65}\n                color=\"var(--color-sequencer)\"\n                connectionPoint={ConnectionPoint.EnvelopeDetectorOutput}\n                text=\"env det out\" />\n        </Section>\n    </Section>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    let patchNotSaved = !state.saved;\n\n    if (state.saved) {\n        patchNotSaved = state.patchEdited || state.saved.name !== state.name;\n    }\n\n    return {\n        ...ownProps,\n        patchName: state.name,\n        saved: state.saved,\n        patch: state.patch,\n        patchNotSaved\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchSetPatchName,\n    dispatchShowModal,\n    dispatchOpenSavedPatch\n};\n\nexport const TopBar = connect(mapStateToProps, mapDispatchToProps)(TopBarImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { listMIDIOutputsAsync } from \"../midi\";\nimport { dispatchConnectCV, dispatchSetMIDIOutput, dispatchDisconnectCV } from \"../store/dispatch\";\nimport { DragPoint, State } from \"../store/reducer\";\nimport { Connection } from \"../types\";\nimport { distance, toSVGCoordinate } from \"../util\";\nimport { Cable } from \"./cable\";\nimport { ConnectionPoint } from \"./jack\";\nimport { ComplexOscillatorView } from \"./modules/complexOscillator\";\nimport { DualLoPassGates } from \"./modules/dualLoPassGates\";\nimport { EnvelopeGenerator } from \"./modules/envelopeGenerator\";\nimport { ModulationOscillator } from \"./modules/modulationOscillator\";\nimport { Patchbay } from \"./modules/patchbay\";\nimport { Pulser } from \"./modules/pulser\";\nimport { Sequencer } from \"./modules/sequencer\";\nimport { TopBar } from \"./modules/topBar\";\n\nexport interface EaselProps {\n    dragPoints: DragPoint[];\n    connections: Connection[];\n    dispatchConnectCV: (startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) => void;\n    dispatchDisconnectCV: (startPoint: ConnectionPoint, startId: number, endPoint: ConnectionPoint, endId: number) => void;\n    dispatchSetMIDIOutput: (name: string) => void;\n}\n\nconst DRAG_RADIUS = 25;\n\nasync function initAsync(dispatchSetMIDIOutput: (name: string) => void) {\n    const inputs = await listMIDIOutputsAsync();\n    for (const input of inputs) {\n        if (input[1].indexOf(\"iProgram\") !== -1) {\n            dispatchSetMIDIOutput(input[0]);\n        }\n    }\n    console.log(`INPUTS: ${inputs.join(\",\")}`)\n}\n\nexport const EaselImpl = (props: EaselProps) => {\n    const { dragPoints, connections, dispatchConnectCV, dispatchDisconnectCV, dispatchSetMIDIOutput } = props;\n\n    const [dragStart, setDragStart] = React.useState<DragPoint>();\n    const [dragEnd, setDragEnd] = React.useState<DOMPoint>();\n\n    React.useEffect(() => {\n        initAsync(dispatchSetMIDIOutput);\n    }, [])\n\n    let svgRef: SVGSVGElement;\n\n    const handleSVGRef = (ref: SVGSVGElement) => {\n        if (ref) svgRef = ref;\n    }\n\n    React.useEffect(() => {\n        const getDragPoint = (svgCoordinate: DOMPoint) => {\n            for (const point of dragPoints) {\n                if (distance(svgCoordinate.x, svgCoordinate.y, point.x, point.y) <= DRAG_RADIUS) {\n                    return point;\n                }\n            }\n        }\n\n        const onPointerDown = (ev: PointerEvent) => {\n            const point = toSVGCoordinate(svgRef, ev.clientX, ev.clientY);\n            const dragPoint = getDragPoint(point);\n\n            if (dragPoint) {\n                setDragStart(dragPoint);\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        }\n\n        const onPointerUp = (ev: PointerEvent) => {\n            if (!dragStart) return;\n            const point = toSVGCoordinate(svgRef, ev.clientX, ev.clientY);\n            const dragPoint = getDragPoint(point);\n\n            if (dragPoint) {\n                const startName = ConnectionPoint[dragStart!.connectionPoint];\n                const endName = ConnectionPoint[dragPoint.connectionPoint];\n                \n                const startIsInput = startName.indexOf(\"Input\") !== -1;\n                const endIsInput = endName.indexOf(\"Input\") !== -1;\n\n                if (startIsInput !== endIsInput) {\n                    dispatchConnectCV(\n                        dragStart!.connectionPoint,\n                        dragStart!.id,\n                        dragPoint.connectionPoint,\n                        dragPoint.id\n                    )\n                }\n            }\n\n            setDragStart(undefined);\n            setDragEnd(undefined);\n        }\n\n        const onPointerMove = (ev: PointerEvent) => {\n            if (!dragStart) return;\n\n            const point = toSVGCoordinate(svgRef, ev.clientX, ev.clientY);\n            setDragEnd(point);\n            ev.preventDefault();\n            ev.stopPropagation();\n        }\n\n        const onPointerLeave = (ev: PointerEvent) => {\n            setDragStart(undefined);\n            setDragEnd(undefined);\n        }\n\n        svgRef.addEventListener(\"pointerdown\", onPointerDown);\n        svgRef.addEventListener(\"pointerup\", onPointerUp);\n        svgRef.addEventListener(\"pointermove\", onPointerMove, true);\n        svgRef.addEventListener(\"pointerleave\", onPointerLeave);\n        \n        return () => {\n            svgRef.removeEventListener(\"pointerdown\", onPointerDown);\n            svgRef.removeEventListener(\"pointerup\", onPointerUp);\n            svgRef.removeEventListener(\"pointermove\", onPointerMove, true);\n            svgRef.removeEventListener(\"pointerleave\", onPointerLeave);\n        }\n    }, [dragStart, dragPoints]);\n\n    const takenColors: boolean[] = [];\n    const cables = dragPoints.length ? connections.map((c, index) => {\n        const start = dragPoints.find(p => c.start.connectionPoint === p.connectionPoint && c.start.id === p.id);\n        const end = dragPoints.find(p => c.end.connectionPoint === p.connectionPoint && c.end.id === p.id);\n        if (!start || !end) return undefined;\n        takenColors[c.color] = true;\n        return <Cable\n            key={index}\n            x0={start!.x}\n            y0={start!.y}\n            x1={end!.x}\n            y1={end!.y}\n            colorIndex={c.color}\n            onClick={() => dispatchDisconnectCV(\n                c.start.connectionPoint,\n                c.start.id,\n                c.end.connectionPoint,\n                c.end.id\n            )} />\n    }) : []\n\n    let nextColor = takenColors.length;\n    for (let i = 0; i < takenColors.length; i++) {\n        if (!takenColors[i]) {\n            nextColor = i;\n            break;\n        }\n    }\n\n    return <svg viewBox=\"0 0 1580 770\" xmlns=\"http://www.w3.org/2000/svg\" ref={handleSVGRef}>\n        <defs>\n            <pattern id=\"stripes\"\n                    x=\"0\" y=\"0\" width=\"8\" height=\"8\"\n                    patternUnits=\"userSpaceOnUse\"\n                    patternTransform=\"rotate(-45)\" >\n\n                <rect\n                    x={0}\n                    y={0}\n                    width={1}\n                    height={8}\n                    fill=\"var(--color-outline)\" />\n\n            </pattern>\n        </defs>\n        <g className=\"easel-content\" transform=\"translate(2, 2)\">\n            <TopBar />\n            <Sequencer />\n            <EnvelopeGenerator />\n            <Pulser />\n            <ModulationOscillator />\n            <ComplexOscillatorView />\n            <DualLoPassGates />\n            <Patchbay />\n            { cables }\n            {dragStart &&\n                <Cable\n                    x0={dragStart.x}\n                    y0={dragStart.y}\n                    x1={dragEnd ? dragEnd.x : dragStart.x}\n                    y1={dragEnd ? dragEnd.y : dragStart.y}\n                    colorIndex={nextColor}\n                    />\n            }\n        </g>\n    </svg>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        dragPoints: state.dragPoints,\n        connections: state.patch.connections\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchConnectCV,\n    dispatchSetMIDIOutput,\n    dispatchDisconnectCV\n};\n\nexport const Easel = connect(mapStateToProps, mapDispatchToProps)(EaselImpl);","export interface ControlProps {\n    id?: string;\n    className?: string;\n    ariaLabel?: string;\n    ariaHidden?: boolean;\n    ariaDescribedBy?: string;\n    role?: string;\n}\n\nexport interface ContainerProps extends React.PropsWithChildren<ControlProps> {\n}\n\nexport function fireClickOnEnter(e: React.KeyboardEvent<HTMLElement>) {\n    const charCode = (typeof e.which == \"number\") ? e.which : e.keyCode;\n    if (charCode === 13 /* enter */ || charCode === 32 /* space */) {\n        e.preventDefault();\n        e.currentTarget.click();\n    }\n}\n\nexport function classList(...classes: (string | undefined | boolean)[]) {\n    return (classes\n        .filter(c => typeof c === \"string\") as string[])\n        .reduce((prev, c) => prev.concat(c.split(\" \")), [] as string[])\n        .map(c => c.trim())\n        .filter(c => !!c)\n        .join(\" \");\n}\n\nexport function nodeListToArray<U extends Node>(list: NodeListOf<U>): U[] {\n    const out: U[] = [];\n\n    for (const node of list) {\n        out.push(node);\n    }\n    return out;\n}","import * as React from \"react\";\nimport { classList, ControlProps, fireClickOnEnter } from \"./util\";\n\nexport interface ButtonViewProps extends ControlProps {\n    buttonRef?: (ref: HTMLButtonElement) => void;\n    title: string;\n    label?: string | JSX.Element;\n    leftIcon?: string;\n    rightIcon?: string;\n    disabled?: boolean;     // Disables the button in an accessible-friendly way.\n    hardDisabled?: boolean; // Disables the button and prevents clicks. Not recommended. Use `disabled` instead.\n    href?: string;\n    target?: string;\n    tabIndex?: number;\n    style?: React.CSSProperties;\n\n    /** Miscellaneous aria pass-through props */\n    ariaControls?: string;\n    ariaExpanded?: boolean;\n    ariaHasPopup?: string;\n    ariaPosInSet?: number;\n    ariaSetSize?: number;\n    ariaSelected?: boolean;\n}\n\n\nexport interface ButtonProps extends ButtonViewProps {\n    onClick: () => void;\n    onBlur?: () => void;\n    onKeydown?: (e: React.KeyboardEvent) => void;\n}\n\nexport const Button = (props: ButtonProps) => {\n    const {\n        id,\n        className,\n        style,\n        ariaLabel,\n        ariaHidden,\n        ariaDescribedBy,\n        ariaControls,\n        ariaExpanded,\n        ariaHasPopup,\n        ariaPosInSet,\n        ariaSetSize,\n        ariaSelected,\n        role,\n        onClick,\n        onKeydown,\n        onBlur,\n        buttonRef,\n        title,\n        label,\n        leftIcon,\n        rightIcon,\n        hardDisabled,\n        href,\n        target,\n        tabIndex\n    } = props;\n\n    let {\n        disabled\n    } = props;\n\n    disabled = disabled || hardDisabled;\n\n\n    const classes = classList(\n        \"common-button\",\n        className,\n        disabled && \"disabled\"\n    );\n\n    let clickHandler = (ev: React.MouseEvent) => {\n        if (onClick) onClick();\n        if (href) window.open(href, target || \"_blank\", \"noopener,noreferrer\")\n        ev.stopPropagation();\n        ev.preventDefault();\n    }\n\n    return (\n        <button\n            id={id}\n            className={classes}\n            style={style}\n            title={title}\n            ref={buttonRef}\n            onClick={!disabled ? clickHandler : undefined}\n            onKeyDown={onKeydown || fireClickOnEnter}\n            onBlur={onBlur}\n            role={role || \"button\"}\n            tabIndex={tabIndex || (disabled ? -1 : 0)}\n            disabled={hardDisabled}\n            aria-label={ariaLabel}\n            aria-hidden={ariaHidden}\n            aria-controls={ariaControls}\n            aria-expanded={ariaExpanded}\n            aria-haspopup={ariaHasPopup as any}\n            aria-posinset={ariaPosInSet}\n            aria-setsize={ariaSetSize}\n            aria-describedby={ariaDescribedBy}\n            aria-selected={ariaSelected}>\n                <span className=\"common-button-flex\">\n                    {leftIcon && <i className={leftIcon} aria-hidden={true}/>}\n                    <span className=\"common-button-label\">\n                        {label}\n                    </span>\n                    {rightIcon && <i className={\"right \" + rightIcon} aria-hidden={true}/>}\n                </span>\n        </button>\n    );\n}","import * as React from \"react\";\nimport { ContainerProps } from \"./util\";\n\nexport interface FocusListProps extends ContainerProps {\n    role: string;\n    childTabStopId?: string;\n    useUpAndDownArrowKeys?: boolean;\n    onItemReceivedFocus?: (item: HTMLElement) => void;\n}\n\n/**\n * A list of focusable items that represents a single tab stop in the tab order. The\n * children of the list can be navigated between using the arrow keys. Any child with\n * a tabindex other than -1 will be included in the list.\n *\n * If childTabStopId is specified, then the tab stop will be placed on the child with\n * the given id instead of the outer div.\n */\nexport const FocusList = (props: FocusListProps) => {\n    const {\n        id,\n        className,\n        role,\n        ariaHidden,\n        ariaLabel,\n        childTabStopId,\n        children,\n        onItemReceivedFocus,\n        useUpAndDownArrowKeys\n    } = props;\n\n    let focusableElements: HTMLElement[];\n    let focusList: HTMLDivElement;\n\n    const handleRef = (ref: HTMLDivElement) => {\n        if (!ref || focusList) return;\n\n        focusList = ref;\n\n        const focusable = ref.querySelectorAll(`[tabindex]:not([tabindex=\"-1\"]),[data-isfocusable]`);\n        focusableElements = [];\n\n        for (const element of focusable.values()) {\n            focusableElements.push(element as HTMLElement);\n\n            // Remove them from the tab order, menu items are navigable using the arrow keys\n            element.setAttribute(\"tabindex\", \"-1\");\n            element.setAttribute(\"data-isfocusable\", \"true\");\n        }\n\n        if (childTabStopId) {\n            const childTabStop = focusList.querySelector(\"#\" + childTabStopId);\n\n            if (childTabStop) {\n                childTabStop.setAttribute(\"tabindex\", \"0\");\n            }\n        }\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\n        if  (!focusableElements?.length) return;\n\n        const target = document.activeElement as HTMLElement;\n        const index = focusableElements.indexOf(target);\n\n        const focus = (element: HTMLElement) => {\n            element.focus();\n            if (onItemReceivedFocus) onItemReceivedFocus(element);\n        }\n\n        if (index === -1 && target !== focusList) return;\n\n        if (e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (target.click) {\n                target.click();\n            }\n            else {\n                // SVG Elements\n                target.dispatchEvent(new Event(\"click\"));\n            }\n        }\n        else if (e.key === (useUpAndDownArrowKeys ? \"ArrowDown\" : \"ArrowRight\")) {\n            if (index === focusableElements.length - 1 || target === focusList) {\n                focus(focusableElements[0]);\n            }\n            else {\n                focus(focusableElements[index + 1]);\n            }\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === (useUpAndDownArrowKeys ? \"ArrowUp\" : \"ArrowLeft\")) {\n            if (index === 0 || target === focusList) {\n                focus(focusableElements[focusableElements.length - 1]);\n            }\n            else {\n                focus(focusableElements[Math.max(index - 1, 0)]);\n            }\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"Home\") {\n            focus(focusableElements[0]);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === \"End\") {\n            focus(focusableElements[focusableElements.length - 1]);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    return (\n        <div id={id}\n            className={className}\n            role={role}\n            tabIndex={childTabStopId ? undefined : 0}\n            onKeyDown={onKeyDown}\n            ref={handleRef}\n            aria-hidden={ariaHidden}\n            aria-label={ariaLabel}>\n            {children}\n        </div>\n    );\n}","import * as React from \"react\";\nimport \"../../styles/dropdown.css\";\n\nimport { classList, ControlProps } from \"./util\";\nimport { Button, ButtonViewProps } from \"./Button\";\nimport { FocusList } from \"./FocusList\";\n\nexport interface DropdownItem extends ButtonViewProps {\n    id: string;\n    role?: \"option\" | undefined;\n}\n\nexport interface DropdownProps extends ControlProps {\n    id: string;\n    selectedId: string;\n    items: DropdownItem[];\n    onItemSelected: (id: string) => void;\n    tabIndex?: number;\n}\n\nexport const Dropdown = (props: DropdownProps) => {\n    const {\n        id,\n        className,\n        ariaHidden,\n        ariaLabel,\n        role,\n        items,\n        tabIndex,\n        selectedId,\n        onItemSelected\n    } = props;\n\n    const [ expanded, setExpanded ] = React.useState(false);\n\n    let container: HTMLDivElement;\n\n    const handleContainerRef = (ref: HTMLDivElement) => {\n        if (!ref) return;\n        container = ref;\n    }\n\n    const onMenuButtonClick = () => {\n        setExpanded(!expanded);\n    }\n\n    const onBlur = (e: React.FocusEvent) => {\n        if (!container) return;\n        if (expanded && !container.contains(e.relatedTarget as HTMLElement)) setExpanded(false);\n    }\n\n    const classes = classList(\"common-dropdown\", className);\n\n    const selected = items.find(item => item.id === selectedId) || items[0];\n    const onItemFocused = (element: HTMLElement) => {\n        if (element.id && items.some(item => item.id === element.id)) onItemSelected(element.id);\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent) => {\n        const selectedIndex = items.indexOf(selected)\n\n        if (e.key === \"ArrowDown\") {\n            if (selectedIndex < items.length - 1) {\n                onItemSelected(items[selectedIndex + 1].id);\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        }\n        else if (e.key === \"ArrowUp\") {\n            if (selectedIndex > 0) {\n                onItemSelected(items[selectedIndex - 1].id);\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        }\n        else if (e.key === \"Enter\") {\n            setExpanded(true);\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    return <div className={classes} ref={handleContainerRef} onBlur={onBlur}>\n        <Button\n            {...selected}\n            id={id}\n            tabIndex={tabIndex}\n            rightIcon={expanded ? \"chevron-up\" : \"chevron-down\"}\n            role={role}\n            className={classList(\"common-dropdown-button\", expanded && \"expanded\", selected.className)}\n            onClick={onMenuButtonClick}\n            onKeydown={onKeyDown}\n            ariaHasPopup=\"listbox\"\n            ariaExpanded={expanded}\n            ariaLabel={ariaLabel}\n            ariaHidden={ariaHidden}\n            />\n        {expanded &&\n            <FocusList role=\"listbox\"\n                className=\"common-menu-dropdown-pane common-dropdown-shadow\"\n                childTabStopId={selectedId}\n                aria-labelledby={id}\n                useUpAndDownArrowKeys={true}\n                onItemReceivedFocus={onItemFocused}>\n                    <ul role=\"presentation\">\n                        { items.map(item =>\n                            <li key={item.id} role=\"presentation\">\n                                <Button\n                                    {...item}\n                                    className={classList(\"common-dropdown-item\", item.className)}\n                                    onClick={() => {\n                                        setExpanded(false);\n                                        onItemSelected(item.id);\n                                    }}\n                                    ariaSelected={item.id === selectedId}\n                                    role=\"option\"/>\n                            </li>\n                        )}\n                    </ul>\n            </FocusList>\n        }\n    </div>\n}","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { listMIDIOutputsAsync } from \"../../midi\";\nimport { dispatchHideModal, dispatchSetMIDIOutput } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { Dropdown, DropdownItem } from \"../common/Dropdown\";\n\nexport interface MidiOutputSelectorProps {\n    dispatchSetMIDIOutput: (id?: string) => void;\n    midiOutput?: string;\n}\n\nconst MidiOutputSelectorImpl = (props: MidiOutputSelectorProps) => {\n    const { dispatchSetMIDIOutput, midiOutput } = props;\n\n    const [midiOutputs, setMidiOutputs] = React.useState<[string, string][]>([]);\n\n    React.useEffect(() => {\n        listMIDIOutputsAsync().then(setMidiOutputs);\n    }, []);\n\n    const outputs: DropdownItem[] = [\n        {\n            label: \"None\",\n            title: \"None\",\n            id: \"None\"\n        }\n    ]\n\n    for (const device of midiOutputs) {\n        outputs.push({\n            label: device[1],\n            title: device[1],\n            id: \"output-\" + device[0]\n        })\n    }\n\n    let selectedOutput = \"None\";\n\n    if (midiOutputs.some(i => i[0] === midiOutput)) {\n        selectedOutput = \"output-\" + midiOutput;\n    }\n\n    const onOutputSelected = (id: string) => {\n        if (id === \"None\") dispatchSetMIDIOutput(undefined);\n        else dispatchSetMIDIOutput(id.split(\"-\").slice(1).join(\"-\"));\n    }\n\n    return <div className=\"modal-field\">\n        <div className=\"modal-field-label\">\n            Midi output:\n        </div>\n        <Dropdown\n            id=\"midi-output\"\n            onItemSelected={onOutputSelected}\n            items={outputs}\n            selectedId={selectedOutput}\n        />\n    </div>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        midiOutput: state.midiOutput,\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchHideModal,\n    dispatchSetMIDIOutput\n};\n\nexport const MidiOutputSelector = connect(mapStateToProps, mapDispatchToProps)(MidiOutputSelectorImpl);","import * as React from \"react\";\nimport { classList, nodeListToArray } from \"./util\";\n\nexport interface FocusTrapProps extends React.PropsWithChildren<{}> {\n    onEscape: () => void;\n    id?: string;\n    className?: string;\n    arrowKeyNavigation?: boolean;\n    dontStealFocus?: boolean;\n    includeOutsideTabOrder?: boolean;\n}\n\nexport const FocusTrap = (props: FocusTrapProps) => {\n    const {\n        children,\n        id,\n        className,\n        onEscape,\n        arrowKeyNavigation,\n        dontStealFocus,\n        includeOutsideTabOrder\n    } = props;\n\n    let container: HTMLDivElement;\n\n    const [stoleFocus, setStoleFocus] = React.useState(false);\n\n    const getElements = () => {\n        const all = nodeListToArray(\n            includeOutsideTabOrder ? container.querySelectorAll(`[tabindex]`) :\n            container.querySelectorAll(`[tabindex]:not([tabindex=\"-1\"])`)\n        );\n\n        return all as HTMLElement[];\n    }\n\n    const handleRef = (ref: HTMLDivElement) => {\n        if (!ref) return;\n        container = ref;\n\n        if (!dontStealFocus && !stoleFocus && !ref.contains(document.activeElement) && getElements().length) {\n            container.focus();\n\n            // Only steal focus once\n            setStoleFocus(true);\n        }\n    }\n\n    const onKeyDown = (e: React.KeyboardEvent) => {\n        if (!container) return;\n\n        const moveFocus = (forward: boolean, goToEnd: boolean) => {\n            const focusable = getElements();\n\n            if (!focusable.length) return;\n\n            const index = focusable.indexOf(e.target as HTMLElement);\n\n            if (forward) {\n                if (goToEnd) {\n                    focusable[focusable.length - 1].focus();\n                }\n                else if (index === focusable.length - 1) {\n                    focusable[0].focus();\n                }\n                else {\n                    focusable[index + 1].focus();\n                }\n            }\n            else {\n                if (goToEnd) {\n                    focusable[0].focus();\n                }\n                else if (index === 0) {\n                    focusable[focusable.length - 1].focus();\n                }\n                else {\n                    focusable[Math.max(index - 1, 0)].focus();\n                }\n            }\n\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        if (e.key === \"Escape\") {\n            onEscape();\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else  if (e.key === \"Tab\") {\n            if (e.shiftKey) moveFocus(false, false);\n            else moveFocus(true, false);\n        }\n        else if (arrowKeyNavigation) {\n            if (e.key === \"ArrowDown\") {\n                moveFocus(true, false);\n            }\n            else if (e.key === \"ArrowUp\") {\n                moveFocus(false, false);\n            }\n            else if (e.key === \"Home\") {\n                moveFocus(false, true);\n            }\n            else if (e.key === \"End\") {\n                moveFocus(true, true);\n            }\n        }\n    }\n\n    return <div id={id}\n        className={classList(\"common-focus-trap\", className)}\n        ref={handleRef}\n        onKeyDown={onKeyDown}\n        tabIndex={-1}>\n        {children}\n    </div>\n}","import * as React from \"react\";\n\n\nimport \"../../styles/modal.css\";\nimport { Button } from \"../common/Button\";\nimport { FocusTrap } from \"../common/FocusTrap\";\n\nexport interface ModalAction {\n    label: string;\n    className?: string;\n    onClick: () => void;\n}\n\nexport interface ModalProps {\n    title: string\n    onCloseClick: () => void;\n    actions?: ModalAction[]\n}\n\nexport const Modal = (props: React.PropsWithChildren<ModalProps>) => {\n    const { title, onCloseClick, actions, children } = props;\n    return <div className=\"modal-container\">\n        <div className=\"modal-background\" onClick={onCloseClick} />\n        <div className=\"modal\">\n            <FocusTrap onEscape={onCloseClick}>\n                <div className=\"modal-title-container\">\n                    <div className=\"modal-title\">\n                        { title }\n                    </div>\n                    <button title=\"Close\" onClick={onCloseClick} tabIndex={0}>✕</button>\n                </div>\n                <div className=\"modal-content\">\n                    { children }\n                </div>\n                { !!actions?.length &&\n                    <div className=\"modal-actions\">\n                        {actions.map(action => {\n                            const { label, onClick, className } = action;\n                            return <Button\n                                key={action.label}\n                                title={label}\n                                label={label}\n                                onClick={onClick}\n                                className={className} />\n                        })}\n                    </div>\n                }\n            </FocusTrap>\n        </div>\n    </div>\n}","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { sendMIDIMessagesAsync } from \"../../midi\";\nimport { createDisconnectAllMessages, createPatchMessages } from \"../../midiMessages\";\nimport { dispatchHideModal, dispatchSetMidiSpeed } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { Easel, MidiMessageSpeed } from \"../../types\";\nimport { CancellationToken } from \"../../util\";\nimport { Dropdown, DropdownItem } from \"../common/Dropdown\";\nimport { MidiOutputSelector } from \"./midiOutputSelector\";\nimport { Modal, ModalAction } from \"./modal\";\n\nexport interface DownloadModalProps {\n    dispatchHideModal: () => void;\n    dispatchSetMidiSpeed: (speed: MidiMessageSpeed) => void;\n    patch: Easel;\n    patchName: string;\n    midiOutput?: string;\n    midiSpeed: MidiMessageSpeed;\n}\n\nexport const DownloadModalImpl = (props: DownloadModalProps) => {\n    const { dispatchHideModal, patch, patchName, midiOutput, midiSpeed, dispatchSetMidiSpeed } = props;\n    \n    const [selectedSlot, setSelectedSlot] = React.useState<string>(\"None\");\n    const [sendingPatch, setSendingPatch] = React.useState(false);\n    const [progress, setProgress] = React.useState(0);\n    const [cancellationToken, setCancellationToken] = React.useState<CancellationToken>();\n\n    const saveSlots: DropdownItem[] = [\n        {\n            label: \"None\",\n            id: \"None\",\n            title: \"None\"\n        }\n    ];\n\n    for (let i = 0; i < 24; i++) {\n        saveSlots.push({\n            label: i < 9 ? \"0\" + (i + 1) : \"\" + (i + 1),\n            title: \"Save Slot \" + (i + 1),\n            id: \"slot-\" + i\n        })\n    }\n\n    const onSaveSlotSelected = (id: string) => {\n        setSelectedSlot(id);\n    }\n\n    const messageSpeeds: DropdownItem[] = [\n        {\n            label: \"Very Slow\",\n            title: \"Very Slow\",\n            id: \"very-slow\"\n        },\n        {\n            label: \"Slow\",\n            title: \"Slow\",\n            id: \"slow\"\n        },\n        {\n            label: \"Medium\",\n            title: \"Medium\",\n            id: \"medium\"\n        },\n        {\n            label: \"Fast\",\n            title: \"Fast\",\n            id: \"fast\"\n        }\n    ];\n\n    const onMidiSpeedSelected = (id: string) => {\n        dispatchSetMidiSpeed(id as MidiMessageSpeed);\n    }\n\n    const actions: ModalAction[] = [];\n\n    if (sendingPatch || midiOutput) {\n        actions.push({\n            label: \"Cancel\",\n            onClick: () => {\n                if (cancellationToken) {\n                    cancellationToken.cancel();\n                }\n                dispatchHideModal();\n            }\n        });\n    }\n\n    if (!sendingPatch && midiOutput) {\n        actions.push({\n            label: \"Send\",\n            onClick: () => {\n                if (cancellationToken) cancellationToken.cancel();\n                setSendingPatch(true);\n                \n                let messages = createPatchMessages(\n                    patch,\n                    true,\n                    patchName,\n                    selectedSlot !== \"None\" ? parseInt(selectedSlot.split(\"-\").slice(-1)[0]) : undefined\n                );\n\n                // Disconnect any connections that might have been made\n                if (selectedSlot === \"None\") {\n                    messages = createDisconnectAllMessages().concat(messages);\n                }\n\n                const token = new CancellationToken();\n                setCancellationToken(token);\n\n                sendMIDIMessagesAsync(midiOutput!, messages, (current, total) => {\n                    setProgress(Math.round((current / total) * 100));\n                }, token)\n                .then(() => {\n                    setCancellationToken(undefined);\n                    dispatchHideModal();\n                });\n            }\n        });\n    }\n\n    const fill = \"var(--color-outline)\"\n    const empty = \"var(--color-background)\"\n\n    return <Modal\n        title=\"Send patch to easel\"\n        onCloseClick={dispatchHideModal}\n        actions={actions}>\n        {!sendingPatch &&\n            <>\n                <div className=\"modal-field\">\n                    <div className=\"modal-field-label\">\n                        Save to slot:\n                    </div>\n                    <Dropdown\n                        id=\"download-save-slot\"\n                        onItemSelected={onSaveSlotSelected}\n                        items={saveSlots}\n                        selectedId={selectedSlot}\n                    />\n                </div>\n                <MidiOutputSelector />\n                <div className=\"modal-field\">\n                    <div className=\"modal-field-label\">\n                        Message speed:\n                    </div>\n                    <Dropdown\n                        id=\"download-midi-speed\"\n                        onItemSelected={onMidiSpeedSelected}\n                        items={messageSpeeds}\n                        selectedId={midiSpeed}\n                    />\n                </div>\n            </>\n        }\n        {sendingPatch &&\n            <div className=\"progress-bar-outer\">\n                <div>\n                    Sending patch to easel...\n                </div>\n                <div className=\"progress-bar\" style={{backgroundImage: `linear-gradient(to right, ${fill} 0%, ${fill} ${progress}%, ${empty} ${progress}%, ${empty} 100%)`}} />\n            </div>\n        }\n    </Modal>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        patch: state.patch,\n        patchName: state.name,\n        midiOutput: state.midiOutput,\n        midiSpeed: state.midiSpeed\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchHideModal,\n    dispatchSetMidiSpeed\n};\n\nexport const DownloadModal = connect(mapStateToProps, mapDispatchToProps)(DownloadModalImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { allPatchesAsync, SavedPatch } from \"../../indexedDB\";\nimport { dispatchHideModal, dispatchOpenSavedPatch } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { formatLastEditedDate } from \"../../util\";\nimport { Modal } from \"./modal\";\n\nimport \"../../styles/fileModal.css\";\n\nexport interface FileModalProps {\n    dispatchHideModal: () => void;\n    dispatchOpenSavedPatch: (patch: SavedPatch) => void;\n}\n\nexport const FileModalImpl = (props: FileModalProps) => {\n    const { dispatchHideModal, dispatchOpenSavedPatch } = props;\n    const [savedProjects, setSavedProjects] = React.useState<SavedPatch[]>([]);\n\n    React.useEffect(() => {\n        allPatchesAsync().then(setSavedProjects)\n    }, [])\n\n    const onPatchClick = (patch: SavedPatch) => {\n        dispatchOpenSavedPatch(patch);\n        dispatchHideModal();\n    }\n\n    return <Modal\n        title=\"Saved patches\"\n        onCloseClick={dispatchHideModal}>\n        <div className=\"saved-patches-scroller\">\n            <div className=\"saved-patches-list\">\n                {savedProjects.map(patch => \n                    <div key={patch.id} className=\"saved-patch-list-item\" onClick={() => onPatchClick(patch)}>\n                        <div className=\"saved-patch-detail\">\n                            <div className=\"saved-patch-name\">\n                                {patch.name}\n                            </div>\n                            <div className=\"saved-patch-time\">\n                                Last edited {formatLastEditedDate(patch.lastSavedTime)}\n                            </div>\n                        </div>\n                        <div className=\"saved-patch-preview\">\n                            <img src={patch.preview} alt=\"Preview of patch\" />\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    </Modal>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchHideModal,\n    dispatchOpenSavedPatch\n};\n\nexport const FileModal = connect(mapStateToProps, mapDispatchToProps)(FileModalImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { listMIDIInputsAsync } from \"../../midi\";\nimport { dispatchHideModal, dispatchSetMIDIInput } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { Dropdown, DropdownItem } from \"../common/Dropdown\";\nimport { MidiOutputSelector } from \"./midiOutputSelector\";\nimport { Modal } from \"./modal\";\n\nexport interface MidiModalProps {\n    dispatchHideModal: () => void;\n    dispatchSetMIDIInput: (id?: string) => void;\n    midiInput?: string;\n}\n\nexport const MidiModalImpl = (props: MidiModalProps) => {\n    const { dispatchHideModal, dispatchSetMIDIInput, midiInput } = props;\n\n    const [midiInputs, setMidiInputs] = React.useState<[string, string][]>([]);\n\n    React.useEffect(() => {\n        listMIDIInputsAsync().then(setMidiInputs);\n    }, [])\n\n    const inputs: DropdownItem[] = [\n        {\n            label: \"None\",\n            title: \"None\",\n            id: \"None\"\n        }\n    ]\n\n    for (const device of midiInputs) {\n        inputs.push({\n            label: device[1],\n            title: device[1],\n            id: \"input-\" + device[0]\n        })\n    }\n\n    let selectedInput = \"None\";\n\n    if (midiInputs.some(i => i[0] === midiInput)) {\n        selectedInput = \"input-\" + midiInput;\n    }\n\n    const onInputSelected = (id: string) => {\n        if (id === \"None\") dispatchSetMIDIInput(undefined);\n        else dispatchSetMIDIInput(id.split(\"-\").slice(1).join(\"-\"));\n    }\n\n    return <Modal\n        title=\"Midi config\"\n        onCloseClick={dispatchHideModal}>\n        <div className=\"modal-field\">\n            <div className=\"modal-field-label\">\n                Midi input:\n            </div>\n            <Dropdown\n                id=\"midi-input\"\n                onItemSelected={onInputSelected}\n                items={inputs}\n                selectedId={selectedInput}\n            />\n        </div>\n        <MidiOutputSelector />\n    </Modal>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        midiInput: state.midiInput\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchHideModal,\n    dispatchSetMIDIInput\n};\n\nexport const MidiModal = connect(mapStateToProps, mapDispatchToProps)(MidiModalImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { dispatchHideModal } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { Modal } from \"./modal\";\n\nexport interface SaveModalProps {\n    dispatchHideModal: () => void;\n}\n\nexport const SaveModalImpl = (props: SaveModalProps) => {\n    const { dispatchHideModal } = props;\n\n    return <Modal\n        title=\"Save patch\"\n        onCloseClick={dispatchHideModal}>\n\n\n    </Modal>\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchHideModal,\n};\n\nexport const SaveModal = connect(mapStateToProps, mapDispatchToProps)(SaveModalImpl);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { dispatchUpdateFader } from \"../../store/dispatch\";\nimport { State } from \"../../store/reducer\";\nimport { ModalState } from \"../../types\";\nimport { DownloadModal } from \"./downloadModal\";\nimport { FileModal } from \"./fileModal\";\nimport { MidiModal } from \"./midiModal\";\nimport { SaveModal } from \"./saveModal\";\n\nexport interface AppModalProps {\n    modalState: ModalState;\n}\n\nexport const AppModalImpl = (props: AppModalProps) => {\n    const { modalState } = props;\n\n    switch (modalState.type) {\n        case \"download\": return <DownloadModal />\n        case \"file\": return <FileModal />\n        case \"midi\": return <MidiModal />\n        case \"save\": return <SaveModal />\n    }\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n        modalState: state.modal\n    }\n}\n\nconst mapDispatchToProps = {\n    dispatchUpdateFader,\n};\n\nexport const AppModal = connect(mapStateToProps, mapDispatchToProps)(AppModalImpl);","import React from 'react';\nimport './App.css';\nimport './styles/colors.css';\nimport { Easel } from './components/easel';\nimport store from './store/store';\nimport { decodePatch, encodePatch, throttle } from './util';\nimport { dispatchSetPatch, dispatchSetPatchEdited } from './store/dispatch';\nimport { State } from './store/reducer';\nimport { connect } from 'react-redux';\nimport { ModalState } from './types';\nimport { AppModal } from './components/modals/appModal';\n\nstore.subscribe(throttle(() => {\n\tconst state = store.getState();\n\tconst current = state.patch;\n\tconst encoded = encodePatch(current);\n\twindow.location.replace(\"#\" + encoded);\n\n\tif (state.saved) {\n\t\tconst edited = state.saved.patch !== encoded;\n\n\t\tif (!!(state.patchEdited) !== edited) {\n\t\t\tstore.dispatch(dispatchSetPatchEdited(edited));\n\t\t}\n\t}\n}, 500))\n\ninterface AppProps {\n\tmodal?: ModalState\n\tdispatchSetPatch: (patch: any) => void;\n}\n\nconst AppImpl = (props: AppProps) => {\n\tconst { modal, dispatchSetPatch } = props;\n\n\tReact.useEffect(() => {\n\t\tconst hash = window.location.hash;\n\n\t\tif (hash?.length > 2) {\n\t\t\tconst state = decodePatch(hash.slice(1));\n\t\t\tdispatchSetPatch(state);\n\t\t}\n\t}, []);\n\t\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<Easel />\n\t\t\t{modal && <AppModal />}\n\t\t</div>\n\t);\n}\n\nfunction mapStateToProps(state: State, ownProps: any) {\n    if (!state) return {};\n\n    return {\n        ...ownProps,\n\t\tmodal: state.modal\n    }\n}\n\nconst mapDispatchToProps = {\n\tdispatchSetPatch\n};\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AppImpl);\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport store from './store/store';\n\nReactDOM.render(\n    <React.StrictMode>\n        <Provider store={store}>\n            <App />\n        </Provider>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}